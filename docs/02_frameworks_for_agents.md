## Introduction to smolagents

1ï¸âƒ£ ì™œ smolagentsë¥¼ ì‚¬ìš©í• ê¹Œ
smolagentsëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ìœ„í•œ ë§ì€ ì˜¤í”ˆì†ŒìŠ¤ ì—ì´ì „íŠ¸ í”„ë ˆì„ì›Œí¬ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ëŒ€ì•ˆìœ¼ë¡œëŠ” ì´ ê°•ì˜ì˜ ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ë‹¤ë£¨ëŠ” LlamaIndexì™€ LangGraphê°€ ìˆìŠµë‹ˆë‹¤. smolagentsëŠ” íŠ¹ì • ì‚¬ìš© ì‚¬ë¡€ì— ì í•©í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ í•µì‹¬ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ë§Œ, í”„ë ˆì„ì›Œí¬ë¥¼ ì„ íƒí•  ë•ŒëŠ” í•­ìƒ ëª¨ë“  ì˜µì…˜ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” smolagentsë¥¼ ì‚¬ìš©í•  ë•Œì˜ ì¥ì ê³¼ ë‹¨ì ì„ ì‚´í´ë³´ê³ , í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ì •ë³´ì— ì…ê°í•œ ê²°ì •ì„ ë‚´ë¦´ ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤„ ê²ƒì…ë‹ˆë‹¤.

2ï¸âƒ£ CodeAgents
CodeAgentsëŠ” smolagentsì—ì„œ ê¸°ë³¸ì´ ë˜ëŠ” ì—ì´ì „íŠ¸ ìœ í˜•ì…ë‹ˆë‹¤. JSONì´ë‚˜ í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ëŒ€ì‹ , ì´ëŸ¬í•œ ì—ì´ì „íŠ¸ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ Python ì½”ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ ëª¨ë“ˆì—ì„œëŠ” CodeAgentsì˜ ëª©ì , ê¸°ëŠ¥, ì‘ë™ ë°©ì‹ë¿ë§Œ ì•„ë‹ˆë¼ ì´ë“¤ì˜ ëŠ¥ë ¥ì„ ë³´ì—¬ì£¼ëŠ” ì‹¤ìŠµ ì˜ˆì œë„ ë‹¤ë£¹ë‹ˆë‹¤.

3ï¸âƒ£ ToolCallingAgents
ToolCallingAgentsëŠ” smolagentsì—ì„œ ì§€ì›ë˜ëŠ” ë‘ ë²ˆì§¸ ìœ í˜•ì˜ ì—ì´ì „íŠ¸ì…ë‹ˆë‹¤. Python ì½”ë“œë¥¼ ìƒì„±í•˜ëŠ” CodeAgentsì™€ëŠ” ë‹¬ë¦¬, ì´ëŸ¬í•œ ì—ì´ì „íŠ¸ëŠ” ì‹œìŠ¤í…œì´ ë¶„ì„í•˜ê³  í•´ì„í•˜ì—¬ ë™ì‘ì„ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” JSON/í…ìŠ¤íŠ¸ ë¸”ë¡­ì— ì˜ì¡´í•©ë‹ˆë‹¤. ì´ ëª¨ë“ˆì€ ê·¸ë“¤ì˜ ê¸°ëŠ¥, CodeAgentsì™€ì˜ ì£¼ìš” ì°¨ì´ì , ê·¸ë¦¬ê³  ì‚¬ìš©ë²•ì„ ë³´ì—¬ì£¼ëŠ” ì˜ˆì œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

4ï¸âƒ£ ë„êµ¬ë“¤
Unit 1ì—ì„œ ë³´ì•˜ë“¯ì´, ë„êµ¬ëŠ” ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ ë‚´ì—ì„œ LLMì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ì´ë©°, ì—ì´ì „íŠ¸ í–‰ë™ì˜ í•„ìˆ˜ì ì¸ êµ¬ì„± ìš”ì†Œ ì—­í• ì„ í•©ë‹ˆë‹¤. ì´ ëª¨ë“ˆì—ì„œëŠ” ë„êµ¬ë¥¼ ë§Œë“œëŠ” ë°©ë²•, ê·¸ êµ¬ì¡°, Tool í´ë˜ìŠ¤ë‚˜ @tool ë°ì½”ë ˆì´í„°ë¥¼ í™œìš©í•œ ë‹¤ì–‘í•œ êµ¬í˜„ ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤. ë˜í•œ ê¸°ë³¸ ì œê³µ ë„êµ¬ ìƒì, ì»¤ë®¤ë‹ˆí‹°ì™€ ë„êµ¬ë¥¼ ê³µìœ í•˜ëŠ” ë°©ë²•, ì»¤ë®¤ë‹ˆí‹° ê¸°ì—¬ ë„êµ¬ë¥¼ ë¡œë“œí•˜ì—¬ ìì‹ ì˜ ì—ì´ì „íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ë°°ìš°ê²Œ ë©ë‹ˆë‹¤.

5ï¸âƒ£ ê²€ìƒ‰ ì—ì´ì „íŠ¸ (Retrieval Agents)
ê²€ìƒ‰ ì—ì´ì „íŠ¸ëŠ” ëª¨ë¸ì´ ì§€ì‹ ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•˜ì—¬, ì—¬ëŸ¬ ì†ŒìŠ¤ë¡œë¶€í„° ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ê³ , ì¢…í•©í•˜ë©°, ì¶”ì¶œí•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ì´ë“¤ì€ ë²¡í„° ìŠ¤í† ì–´ë¥¼ í™œìš©í•˜ì—¬ íš¨ìœ¨ì ì¸ ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ê³ , RAG(Retrieval-Augmented Generation) íŒ¨í„´ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì—ì´ì „íŠ¸ëŠ” ì›¹ ê²€ìƒ‰ê³¼ ì‚¬ìš©ì ì •ì˜ ì§€ì‹ ë² ì´ìŠ¤ë¥¼ í†µí•©í•˜ë©´ì„œë„ ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œì„ í†µí•´ ëŒ€í™”ì˜ ë§¥ë½ì„ ìœ ì§€í•˜ëŠ” ë° íŠ¹íˆ ìœ ìš©í•©ë‹ˆë‹¤. ì´ ëª¨ë“ˆì—ì„œëŠ” ê°•ê±´í•œ ì •ë³´ ê²€ìƒ‰ì„ ìœ„í•œ í´ë°±(fallback) ë©”ì»¤ë‹ˆì¦˜ì„ í¬í•¨í•œ êµ¬í˜„ ì „ëµì„ ë‹¤ë£¹ë‹ˆë‹¤.

6ï¸âƒ£ ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ (Multi-Agent Systems)
ê°•ë ¥í•œ ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ë ¤ë©´ ì—¬ëŸ¬ ì—ì´ì „íŠ¸ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì¡°ìœ¨í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸ì™€ ì½”ë“œ ì‹¤í–‰ ì—ì´ì „íŠ¸ë¥¼ ê²°í•©í•˜ë©´ ë” ì •êµí•œ ì†”ë£¨ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª¨ë“ˆì€ ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì„ íš¨ìœ¨ì ì´ê³  ì•ˆì •ì ìœ¼ë¡œ ì„¤ê³„, êµ¬í˜„, ê´€ë¦¬í•˜ëŠ” ë° ì´ˆì ì„ ë§ì¶¥ë‹ˆë‹¤.

7ï¸âƒ£ ë¹„ì „ ë° ë¸Œë¼ìš°ì € ì—ì´ì „íŠ¸ (Vision and Browser Agents)
ë¹„ì „ ì—ì´ì „íŠ¸ëŠ” Vision-Language Model(VLM)ì„ í†µí•©í•˜ì—¬ ê¸°ì¡´ ì—ì´ì „íŠ¸ì˜ ê¸°ëŠ¥ì„ í™•ì¥í•˜ë©°, ì‹œê° ì •ë³´ë¥¼ ì²˜ë¦¬í•˜ê³  í•´ì„í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ ëª¨ë“ˆì—ì„œëŠ” ì´ë¯¸ì§€ ê¸°ë°˜ ì¶”ë¡ , ì‹œê°ì  ë°ì´í„° ë¶„ì„, ë©€í‹°ëª¨ë‹¬ ìƒí˜¸ì‘ìš©ê³¼ ê°™ì€ ê³ ê¸‰ ê¸°ëŠ¥ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” VLM ê¸°ë°˜ ì—ì´ì „íŠ¸ì˜ ì„¤ê³„ ë° í†µí•© ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤. ë˜í•œ, ë¹„ì „ ì—ì´ì „íŠ¸ë¥¼ í™œìš©í•˜ì—¬ ì›¹ì„ íƒìƒ‰í•˜ê³  ì •ë³´ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ë¸Œë¼ìš°ì € ì—ì´ì „íŠ¸ë¥¼ êµ¬ì¶•í•©ë‹ˆë‹¤.

## ì™œ smolagentsë¥¼ ì‚¬ìš©í• ê¹Œ
ì´ ëª¨ë“ˆì—ì„œëŠ” smolagentsë¥¼ ì‚¬ìš©í•  ë•Œì˜ ì¥ë‹¨ì ì„ ì‚´í´ë³´ê³ , ì´ í”„ë ˆì„ì›Œí¬ê°€ ì—¬ëŸ¬ë¶„ì˜ ìš”êµ¬ì— ì í•©í•œì§€ì— ëŒ€í•œ ì •ë³´ì— ì…ê°í•œ ê²°ì •ì„ ë‚´ë¦´ ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤„ ê²ƒì…ë‹ˆë‹¤.

### smolagentsë€?

smolagentsëŠ” ê°„ë‹¨í•˜ì§€ë§Œ ê°•ë ¥í•œ AI ì—ì´ì „íŠ¸ êµ¬ì¶• í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. ì´ í”„ë ˆì„ì›Œí¬ëŠ” LLMì´ ê²€ìƒ‰í•˜ê±°ë‚˜ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” ë“±ì˜ ë°©ì‹ìœ¼ë¡œ ì‹¤ì œ ì„¸ê³„ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

Unit 1ì—ì„œ ë°°ìš´ ê²ƒì²˜ëŸ¼, AI ì—ì´ì „íŠ¸ëŠ” â€™ê´€ì°°(observations)â€™ì„ ë°”íƒ•ìœ¼ë¡œ â€™ìƒê°(thoughts)â€™ì„ ìƒì„±í•˜ê³  ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ â€™í–‰ë™(actions)â€™ì„ ìˆ˜í–‰í•˜ëŠ” í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. ì´ì œ ì´ê²ƒì´ smolagentsì—ì„œ ì–´ë–»ê²Œ êµ¬í˜„ë˜ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

smolagentsì˜ ì£¼ìš” ì¥ì 
- ë‹¨ìˆœí•¨: ì½”ë“œ ë³µì¡ë„ì™€ ì¶”ìƒí™”ê°€ ìµœì†Œí™”ë˜ì–´ í”„ë ˆì„ì›Œí¬ë¥¼ ì´í•´í•˜ê³  ì±„íƒí•˜ë©° í™•ì¥í•˜ê¸° ì‰¬ì›€
- ìœ ì—°í•œ LLM ì§€ì›: Hugging Face ë„êµ¬ì™€ ì™¸ë¶€ APIì™€ì˜ í†µí•©ì„ í†µí•´ ì–´ë–¤ LLMê³¼ë„ ì‘ë™ ê°€ëŠ¥
- ì½”ë“œ ìš°ì„  ì ‘ê·¼ ë°©ì‹: ì—ì´ì „íŠ¸ê°€ ì§ì ‘ ì½”ë“œë¡œ ë™ì‘ì„ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” Code Agentì— ëŒ€í•œ ì¼ê¸‰ ì§€ì›ìœ¼ë¡œ, íŒŒì‹±ì´ í•„ìš” ì—†ê³  ë„êµ¬ í˜¸ì¶œì´ ê°„ë‹¨í•´ì§
- HF Hub í†µí•©: Hugging Face Hubì™€ì˜ ì›í™œí•œ í†µí•©ì„ í†µí•´ Gradio Spacesë¥¼ ë„êµ¬ë¡œ í™œìš© ê°€ëŠ¥

ì–¸ì œ smolagentsë¥¼ ì‚¬ìš©í• ê¹Œ?
ì´ëŸ¬í•œ ì¥ì ì„ ê³ ë ¤í•  ë•Œ, ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬ ëŒ€ì‹  smolagentsë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
- ê°€ë³ê³  ìµœì†Œí•œì˜ ì†”ë£¨ì…˜ì´ í•„ìš”í•œ ê²½ìš°
- ë³µì¡í•œ ì„¤ì • ì—†ì´ ë¹ ë¥´ê²Œ ì‹¤í—˜í•˜ê³  ì‹¶ì€ ê²½ìš°
- ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì´ ë‹¨ìˆœí•œ ê²½ìš°


### ì½”ë“œ vs. JSON ì•¡ì…˜

ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬ì—ì„œëŠ” ì—ì´ì „íŠ¸ê°€ ì‘ì—…ì„ JSON í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” ê²½ìš°ê°€ ë§ì€ ë°˜ë©´, smolagentsëŠ” ì½”ë“œ ê¸°ë°˜ì˜ ë„êµ¬ í˜¸ì¶œì— ì´ˆì ì„ ë§ì¶”ì–´ ì‹¤í–‰ ê³¼ì •ì„ ë‹¨ìˆœí™”í•©ë‹ˆë‹¤.

ì´ëŠ” ë„êµ¬ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ JSONì„ íŒŒì‹±í•  í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì´ë©°, ì¶œë ¥ ê²°ê³¼ë¥¼ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ ë‹¤ì´ì–´ê·¸ë¨ì€ ì´ëŸ¬í•œ ì°¨ì´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤:

![alt text](image-4.png)


### smolagentsì˜ ì—ì´ì „íŠ¸ ìœ í˜•

smolagentsì˜ ì—ì´ì „íŠ¸ëŠ” ë‹¤ë‹¨ê³„(Multi-step) ì—ì´ì „íŠ¸ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

ê° MultiStepAgentëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•©ë‹ˆë‹¤:
- í•˜ë‚˜ì˜ thought ìƒì„±
- í•˜ë‚˜ì˜ ë„êµ¬ í˜¸ì¶œ ë° ì‹¤í–‰

ê¸°ë³¸ ì—ì´ì „íŠ¸ ìœ í˜•ìœ¼ë¡œ CodeAgentë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ì™¸ì—ë„, smolagentsëŠ” ë„êµ¬ í˜¸ì¶œì„ JSON í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” ToolCallingAgentë„ ì§€ì›í•©ë‹ˆë‹¤.

ê° ì—ì´ì „íŠ¸ ìœ í˜•ì— ëŒ€í•´ì„œëŠ” ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ë” ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

smolagentsì—ì„œëŠ” ë„êµ¬ë¥¼ Python í•¨ìˆ˜ì— @tool ë°ì½”ë ˆì´í„°ë¥¼ ì”Œìš°ê±°ë‚˜ Tool í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì˜í•©ë‹ˆë‹¤.

â¸»

### smolagentsì—ì„œì˜ ëª¨ë¸ í†µí•©

smolagentsëŠ” ìœ ì—°í•œ LLM í†µí•©ì„ ì§€ì›í•˜ë©°, íŠ¹ì • ê¸°ì¤€ì„ ì¶©ì¡±í•˜ëŠ” ëª¨ë“  callable ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”„ë ˆì„ì›Œí¬ëŠ” ëª¨ë¸ ì—°ê²°ì„ ê°„ì†Œí™”í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ê°€ì§€ ë¯¸ë¦¬ ì •ì˜ëœ í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤:
- TransformersModel: ë¡œì»¬ transformers íŒŒì´í”„ë¼ì¸ì„ êµ¬í˜„í•˜ì—¬ ì›í™œí•œ í†µí•© ì§€ì›
- HfApiModel: Hugging Face ì¸í”„ë¼ ë˜ëŠ” ë‹¤ì–‘í•œ ì„œë“œíŒŒí‹° ì¶”ë¡  ì„œë¹„ìŠ¤ì™€ ì—°ë™ë˜ëŠ” ì„œë²„ë¦¬ìŠ¤ ì¶”ë¡  ì§€ì›
- LiteLLMModel: LiteLLMì„ í™œìš©í•˜ì—¬ ê²½ëŸ‰í™”ëœ ëª¨ë¸ ìƒí˜¸ì‘ìš© ì œê³µ
- OpenAIServerModel: OpenAI API ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ì™€ ì—°ê²° ê°€ëŠ¥
- AzureOpenAIServerModel: Azure OpenAI ë°°í¬ì™€ì˜ í†µí•©ì„ ì§€ì›

ì´ëŸ¬í•œ ìœ ì—°ì„± ë•ë¶„ì— ê°œë°œìëŠ” íŠ¹ì • ì‚¬ìš© ì‚¬ë¡€ì— ê°€ì¥ ì í•©í•œ ëª¨ë¸ê³¼ ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìœ¼ë©°, ì‹¤í—˜ë„ ì‰½ê²Œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì œ smolagentsë¥¼ ì–¸ì œ ì™œ ì‚¬ìš©í•˜ëŠ”ì§€ ì´í•´í–ˆìœ¼ë‹ˆ, ì´ ê°•ë ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë” ê¹Šì´ ì‚´í´ë³´ë„ë¡ í•©ì‹œë‹¤!

## Building Agents That Use Code

Code AgentëŠ” smolagentsì—ì„œ ê¸°ë³¸ ì—ì´ì „íŠ¸ ìœ í˜•ì…ë‹ˆë‹¤. ì´ë“¤ì€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ Python ë„êµ¬ í˜¸ì¶œì„ ìƒì„±í•˜ë©°, íš¨ìœ¨ì ì´ê³  í‘œí˜„ë ¥ì´ ë›°ì–´ë‚˜ë©° ì •í™•í•œ ì‘ì—… í‘œí˜„ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ê°„ê²°í•œ ì ‘ê·¼ ë°©ì‹ì€ í•„ìš”í•œ ì‘ì—… ìˆ˜ë¥¼ ì¤„ì´ê³ , ë³µì¡í•œ ì—°ì‚°ì„ ë‹¨ìˆœí™”í•˜ë©°, ê¸°ì¡´ ì½”ë“œ í•¨ìˆ˜ì˜ ì¬ì‚¬ìš©ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. smolagentsëŠ” ì•½ 1,000ì¤„ ì •ë„ì˜ ì½”ë“œë¡œ êµ¬í˜„ëœ ê²½ëŸ‰ í”„ë ˆì„ì›Œí¬ë¥¼ í†µí•´ Code Agentë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•©ë‹ˆë‹¤.

## ì™œ Code Agentì¸ê°€?
ë‹¤ë‹¨ê³„ ì—ì´ì „íŠ¸ í”„ë¡œì„¸ìŠ¤ì—ì„œëŠ” LLMì´ ì‘ì—…ì„ ì‘ì„±í•˜ê³  ì‹¤í–‰í•˜ë©°, ì´ ì‘ì—…ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì™¸ë¶€ ë„êµ¬ í˜¸ì¶œì´ í¬í•¨ë©ë‹ˆë‹¤. ì „í†µì ì¸ ë°©ì‹ì—ì„œëŠ” ë„êµ¬ ì´ë¦„ê³¼ ì¸ìë¥¼ ë¬¸ìì—´ë¡œ ëª…ì‹œí•œ JSON í˜•ì‹ì„ ì‚¬ìš©í•˜ê³ , ì‹œìŠ¤í…œì´ ì´ë¥¼ íŒŒì‹±í•˜ì—¬ ì–´ë–¤ ë„êµ¬ë¥¼ ì‹¤í–‰í• ì§€ ê²°ì •í•´ì•¼ í•©ë‹ˆë‹¤.

í•˜ì§€ë§Œ ì—°êµ¬ì— ë”°ë¥´ë©´, LLMì€ ì½”ë“œë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì—ì„œ ë„êµ¬ í˜¸ì¶œì„ ë” íš¨ê³¼ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” smolagentsì˜ í•µì‹¬ ì›ì¹™ ì¤‘ í•˜ë‚˜ì´ë©°, ì´ëŠ” Executable Code Actions Elicit Better LLM Agents ë…¼ë¬¸ì— ë‚˜ì˜¨ ìœ„ ë‹¤ì´ì–´ê·¸ë¨ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

https://huggingface.co/papers/2402.01030


ì‘ì—…ì„ JSONì´ ì•„ë‹Œ ì½”ë“œë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì€ ë‹¤ìŒê³¼ ê°™ì€ ì£¼ìš” ì¥ì ì„ ì œê³µí•©ë‹ˆë‹¤:
- ì¡°í•© ê°€ëŠ¥ì„± (Composability): ì‘ì—…ì„ ì‰½ê²Œ ê²°í•©í•˜ê³  ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
- ê°ì²´ ê´€ë¦¬ (Object Management): ì´ë¯¸ì§€ì™€ ê°™ì€ ë³µì¡í•œ êµ¬ì¡°ë¥¼ ì§ì ‘ ë‹¤ë£° ìˆ˜ ìˆìŒ
- ë²”ìš©ì„± (Generality): ê³„ì‚°ì ìœ¼ë¡œ ê°€ëŠ¥í•œ ì–´ë–¤ ì‘ì—…ì´ë“  í‘œí˜„ ê°€ëŠ¥
- LLM ì¹œí™”ì„± (Natural for LLMs): ê³ í’ˆì§ˆì˜ ì½”ë“œê°€ ì´ë¯¸ LLMì˜ í•™ìŠµ ë°ì´í„°ì— í’ë¶€í•˜ê²Œ í¬í•¨ë˜ì–´ ìˆìŒ

## How Does a Code Agent Work?

![alt text](image-5.png)

ìœ„ ë‹¤ì´ì–´ê·¸ë¨ì€ CodeAgent.run()ì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ë©°, ì´ëŠ” Unit 1ì—ì„œ ì–¸ê¸‰í–ˆë˜ ReAct í”„ë ˆì„ì›Œí¬ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
smolagentsì—ì„œ ì—ì´ì „íŠ¸ë¥¼ ìœ„í•œ ì£¼ìš” ì¶”ìƒí™”ëŠ” MultiStepAgentì´ë©°, ì´ëŠ” í•µì‹¬ êµ¬ì„± ìš”ì†Œ ì—­í• ì„ í•©ë‹ˆë‹¤. CodeAgentëŠ” íŠ¹ë³„í•œ ì¢…ë¥˜ì˜ MultiStepAgentë¡œ, ì•„ë˜ ì˜ˆì œì—ì„œ ë” ìì„¸íˆ ì‚´í´ë³´ê²Œ ë©ë‹ˆë‹¤.

â¸»

### CodeAgentì˜ ì‘ë™ íë¦„

CodeAgentëŠ” ì¼ë ¨ì˜ ë‹¨ê³„ë“¤ì„ ë°˜ë³µí•˜ë©´ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©°, ê¸°ì¡´ ë³€ìˆ˜ì™€ ì§€ì‹ì€ ì—ì´ì „íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸ì— í†µí•©ë˜ê³  ì´ ì •ë³´ëŠ” execution logì— ì €ì¥ë©ë‹ˆë‹¤.
1.	SystemPromptStepì—ëŠ” ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ê°€ ì €ì¥ë˜ê³ , TaskStepì—ëŠ” ì‚¬ìš©ìì˜ ì¿¼ë¦¬ê°€ ê¸°ë¡ë©ë‹ˆë‹¤.
2.	ê·¸ í›„ ë‹¤ìŒê³¼ ê°™ì€ while ë£¨í”„ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤:
    2.1 agent.write_memory_to_messages() ë©”ì„œë“œëŠ” ì—ì´ì „íŠ¸ì˜ ë¡œê·¸ë¥¼ LLMì´ ì½ì„ ìˆ˜ ìˆëŠ” ì±„íŒ… ë©”ì‹œì§€ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
    2.2 ì´ ë©”ì‹œì§€ë“¤ì€ ëª¨ë¸ë¡œ ì „ì†¡ë˜ê³ , ëª¨ë¸ì€ ì‘ë‹µ(completion)ì„ ìƒì„±í•©ë‹ˆë‹¤.
    2.3 ì´ ì‘ë‹µì—ì„œ ì‘ì—…ì´ íŒŒì‹±ë˜ë©°, CodeAgentì˜ ê²½ìš° ì´ëŠ” ì½”ë“œ ìŠ¤ë‹ˆí«ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
    2.4 ì´ ì½”ë“œê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.
    2.5 ì‹¤í–‰ ê²°ê³¼ëŠ” ë©”ëª¨ë¦¬ì— ActionStepìœ¼ë¡œ ê¸°ë¡ë©ë‹ˆë‹¤.
3.	ê° ë‹¨ê³„ì˜ ëì—ì„œ, ë§Œì•½ agent.step_callbackì— í•¨ìˆ˜ í˜¸ì¶œì´ í¬í•¨ë˜ì–´ ìˆë‹¤ë©´, ê·¸ê²ƒë„ ì‹¤í–‰ë©ë‹ˆë‹¤.

â¸»

ì´ êµ¬ì¡°ë¥¼ í†µí•´ CodeAgentëŠ” ëª…í™•í•œ ë§¥ë½ ê¸°ë°˜ ì¶”ë¡ ê³¼ ë„êµ¬ ì‹¤í–‰ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ë©°, ë‹¤ë‹¨ê³„ì˜ ì‚¬ê³ -í–‰ë™ ë£¨í”„ë¥¼ í†µí•´ ë³µì¡í•œ ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì—ì´ì „íŠ¸ ë‚´ë¶€ì—ì„œ Python ëª¨ë“ˆ ì„í¬íŠ¸í•˜ê¸°
ì´ì œ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì™€ ë©”ë‰´ëŠ” ì¤€ë¹„ë˜ì—ˆì§€ë§Œ, í•œ ê°€ì§€ ì¤‘ìš”í•œ ìš”ì†Œë¥¼ ë” í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤: ì¡°ë¦¬ ì‹œê°„ì…ë‹ˆë‹¤!

AlfredëŠ” ì§€ê¸ˆ ì¤€ë¹„ë¥¼ ì‹œì‘í•œë‹¤ê³  í–ˆì„ ë•Œ, ëª¨ë“  ê²ƒì´ ì–¸ì œ ì¤€ë¹„ë ì§€ë¥¼ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤. ë§Œì•½ ì‹œê°„ì´ ë¶€ì¡±í•˜ë‹¤ë©´ ë‹¤ë¥¸ ìŠˆí¼íˆì–´ë¡œë“¤ì˜ ë„ì›€ì´ í•„ìš”í•  ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì´ì£ .

â¸»

smolagentsëŠ” Python ì½”ë“œ ìŠ¤ë‹ˆí«ì„ ì‘ì„±í•˜ê³  ì‹¤í–‰í•˜ëŠ” ë° íŠ¹í™”ëœ ì—ì´ì „íŠ¸ í”„ë ˆì„ì›Œí¬ì´ë©°, ë³´ì•ˆì„ ìœ„í•œ ìƒŒë“œë°•ìŠ¤ ì‹¤í–‰ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.
- ì½”ë“œ ì‹¤í–‰ì—ëŠ” ì—„ê²©í•œ ë³´ì•ˆ ì¡°ì¹˜ê°€ ì ìš©ë˜ë©°, ì‚¬ì „ì— ì •ì˜ëœ ì•ˆì „í•œ ëª©ë¡(safe list)ì— ì—†ëŠ” ëª¨ë“ˆì€ ê¸°ë³¸ì ìœ¼ë¡œ ì„í¬íŠ¸ê°€ ì°¨ë‹¨ë©ë‹ˆë‹¤.
- í•˜ì§€ë§Œ additional_authorized_importsì— ë¬¸ìì—´ í˜•íƒœë¡œ ëª¨ë“ˆ ì´ë¦„ì„ ì „ë‹¬í•˜ë©´ ì¶”ê°€ì ì¸ ì„í¬íŠ¸ë¥¼ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë³´ì•ˆì´ ì ìš©ëœ ì½”ë“œ ì‹¤í–‰ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ê³µì‹ ê°€ì´ë“œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



```python
from smolagents import CodeAgent, HfApiModel
import numpy as np
import time
import datetime

agent = CodeAgent(tools=[], model=HfApiModel(), additional_authorized_imports=['datetime'])

agent.run(
    """
    Alfred needs to prepare for the party. Here are the tasks:
    1. Prepare the drinks - 30 minutes
    2. Decorate the mansion - 60 minutes
    3. Set up the menu - 45 minutes
    4. Prepare the music and playlist - 45 minutes

    If we start right now, at what time will the party be ready?
    """
)
```

ì´ ì˜ˆì œë“¤ì€ Code Agentë¥¼ í™œìš©í•´ í•  ìˆ˜ ìˆëŠ” ì¼ë“¤ì˜ ì‹œì‘ì— ë¶ˆê³¼í•˜ë©°, ì§€ê¸ˆê¹Œì§€ ì‚´í´ë³¸ ê²ƒë§Œìœ¼ë¡œë„ íŒŒí‹° ì¤€ë¹„ì—ì„œ ê·¸ ìœ ìš©ì„±ì´ ë“œëŸ¬ë‚˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. Code Agentë¥¼ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë” ì•Œê³  ì‹¶ë‹¤ë©´ smolagents ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

ìš”ì•½í•˜ìë©´, smolagentsëŠ” Python ì½”ë“œ ìŠ¤ë‹ˆí«ì„ ì‘ì„±í•˜ê³  ì‹¤í–‰í•˜ëŠ” ì—ì´ì „íŠ¸ì— íŠ¹í™”ëœ í”„ë ˆì„ì›Œí¬ë¡œ, ë³´ì•ˆì„ ìœ„í•œ ìƒŒë“œë°•ìŠ¤ ì‹¤í–‰ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤. ë˜í•œ ë¡œì»¬ ë° API ê¸°ë°˜ ì–¸ì–´ ëª¨ë¸ ëª¨ë‘ë¥¼ ì§€ì›í•˜ì—¬ ë‹¤ì–‘í•œ ê°œë°œ í™˜ê²½ì— ìœ ì—°í•˜ê²Œ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìš°ë¦¬ë§Œì˜ ë§ì¶¤í˜• íŒŒí‹° ì¤€ë¹„ ì—ì´ì „íŠ¸ë¥¼ Hubì— ê³µìœ í•˜ê¸°
ìš°ë¦¬ì˜ Alfred ì—ì´ì „íŠ¸ë¥¼ ì»¤ë®¤ë‹ˆí‹°ì™€ ê³µìœ í•  ìˆ˜ ìˆë‹¤ë©´ ì •ë§ ë©‹ì§€ì§€ ì•Šì„ê¹Œìš”? ê·¸ë ‡ê²Œ í•˜ë©´ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì´ ì—ì´ì „íŠ¸ë¥¼ Hubì—ì„œ ë‹¤ìš´ë¡œë“œí•´ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , ê³ ë‹´ ìµœê³ ì˜ íŒŒí‹° í”Œë˜ë„ˆë¥¼ ì†ì‰½ê²Œ í™œìš©í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤! ì, ì´ì œ ì§ì ‘ í•´ë´…ì‹œë‹¤! ğŸ‰

â¸»

smolagents ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì»¤ë®¤ë‹ˆí‹°ì™€ ì™„ì„±ëœ ì—ì´ì „íŠ¸ë¥¼ ê³µìœ í•˜ê³ , ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ë§Œë“  ì—ì´ì „íŠ¸ë¥¼ ì¦‰ì‹œ ë‹¤ìš´ë¡œë“œí•´ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

ë°©ë²•ë„ ì•„ì£¼ ê°„ë‹¨í•©ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì´ í•˜ë©´ ë©ë‹ˆë‹¤:

agent.push_to_hub("your-username/alfred-party-agent")

ì´ë ‡ê²Œ í•˜ë©´ ì—¬ëŸ¬ë¶„ì˜ ë§ì¶¤í˜• ì—ì´ì „íŠ¸ê°€ Hugging Face Hubì— ì—…ë¡œë“œë˜ê³ , ë‹¤ë¥¸ ì‚¬ëŒë“¤ì€ ì•„ë˜ì™€ ê°™ì´ ê°„ë‹¨íˆ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

agent = CodeAgent.from_hub("your-username/alfred-party-agent")



â¸»

ì´ì œ AlfredëŠ” ì—¬ëŸ¬ë¶„ë§Œì˜ ë„ìš°ë¯¸ê°€ ì•„ë‹ˆë¼, ì „ ì„¸ê³„ ëˆ„êµ¬ë‚˜ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íŒŒí‹° ì¤€ë¹„ ë§ˆìŠ¤í„°ê°€ ë©ë‹ˆë‹¤! ğŸ¦¸â€â™‚ï¸ğŸ‚ğŸª©


íŒŒí‹° ì¤€ë¹„ ì—ì´ì „íŠ¸ë¥¼ OpenTelemetryì™€ Langfuseë¡œ ì‚´í´ë³´ê¸° ğŸ“¡
AlfredëŠ” Party Preparator Agentë¥¼ ì¡°ì •í•˜ëŠ” ê³¼ì •ì—ì„œ ë””ë²„ê¹…ì— ì ì  ì§€ì³ê°€ê³  ìˆìŠµë‹ˆë‹¤. ì—ì´ì „íŠ¸ëŠ” ë³¸ì§ˆì ìœ¼ë¡œ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•˜ë©°, ë™ì‘ì„ ì¶”ì í•˜ê¸°ë„ ì–´ë µê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ëŠ” ì´ ì—ì´ì „íŠ¸ë¥¼ í”„ë¡œë•ì…˜ì— ë°°í¬í•˜ê³ ì í•˜ë¯€ë¡œ, ë¯¸ë˜ì˜ ëª¨ë‹ˆí„°ë§ê³¼ ë¶„ì„ì„ ìœ„í•œ ê°•ë ¥í•œ ì¶”ì  ê¸°ëŠ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.

ì—¬ê¸°ì„œë„ smolagentsê°€ í•´ê²°ì±…ì´ ë©ë‹ˆë‹¤!
smolagentsëŠ” ì—ì´ì „íŠ¸ ì‹¤í–‰ì„ ê³„ì¸¡í•˜ê¸° ìœ„í•´ OpenTelemetry í‘œì¤€ì„ ì§€ì›í•˜ë©°, ì´ë¥¼ í†µí•´ ì‹¤í–‰ì„ ì‰½ê²Œ ì¶”ì í•˜ê³  ë¡œê·¸ë¥¼ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Langfuseì™€ SmolagentsInstrumentorì˜ ë„ì›€ìœ¼ë¡œ, AlfredëŠ” ìì‹ ì˜ ì—ì´ì „íŠ¸ ë™ì‘ì„ ê°„í¸í•˜ê²Œ ì¶”ì í•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

â¸»

ì„¤ì •ì€ ì•„ì£¼ ê°„ë‹¨í•©ë‹ˆë‹¤!

âœ… ë¨¼ì € í•„ìš”í•œ ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤:

pip install opentelemetry-sdk opentelemetry-exporter-otlp openinference-instrumentation-smolagents

âœ… AlfredëŠ” ì´ë¯¸ Langfuse ê³„ì •ì„ ë§Œë“¤ê³  API í‚¤ë¥¼ í™•ë³´í•œ ìƒíƒœì…ë‹ˆë‹¤. ì•„ì§ ê³„ì •ì´ ì—†ë‹¤ë©´ Langfuse Cloudì—ì„œ ê°€ì…í•˜ê±°ë‚˜ ë‹¤ë¥¸ ëŒ€ì•ˆì„ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

âœ… API í‚¤ë¥¼ í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •í•©ë‹ˆë‹¤:
```python
import os
import base64

LANGFUSE_PUBLIC_KEY = "pk-lf-..."
LANGFUSE_SECRET_KEY = "sk-lf-..."
LANGFUSE_AUTH = base64.b64encode(f"{LANGFUSE_PUBLIC_KEY}:{LANGFUSE_SECRET_KEY}".encode()).decode()

os.environ["OTEL_EXPORTER_OTLP_ENDPOINT"] = "https://cloud.langfuse.com/api/public/otel"  # EU ë¦¬ì „
# os.environ["OTEL_EXPORTER_OTLP_ENDPOINT"] = "https://us.cloud.langfuse.com/api/public/otel"  # ë¯¸êµ­ ë¦¬ì „
os.environ["OTEL_EXPORTER_OTLP_HEADERS"] = f"Authorization=Basic {LANGFUSE_AUTH}"

âœ… ì´ì œ AlfredëŠ” SmolagentsInstrumentorë¥¼ ì´ˆê¸°í™”í•˜ì—¬ ì¶”ì ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

from opentelemetry.sdk.trace import TracerProvider
from openinference.instrumentation.smolagents import SmolagentsInstrumentor
from opentelemetry.exporter.otlp.proto.http.trace_exporter import OTLPSpanExporter
from opentelemetry.sdk.trace.export import SimpleSpanProcessor

trace_provider = TracerProvider()
trace_provider.add_span_processor(SimpleSpanProcessor(OTLPSpanExporter()))

SmolagentsInstrumentor().instrument(tracer_provider=trace_provider)
```

â¸»

ì´ì œ AlfredëŠ” Langfuseì™€ ì—°ê²° ì™„ë£Œ ğŸ”Œ
smolagentsì—ì„œ ë°œìƒí•˜ëŠ” ì‹¤í–‰ ë¡œê·¸ëŠ” Langfuseì— ê¸°ë¡ë˜ë©°, ì—ì´ì „íŠ¸ì˜ ë™ì‘ì„ ì™„ì „íˆ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. AlfredëŠ” ì´ì „ ì‹¤í–‰ì„ ê²€í† í•˜ê³  ì—ì´ì „íŠ¸ë¥¼ ë”ìš± ì •êµí•˜ê²Œ ë‹¤ë“¬ì„ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
```python
from smolagents import CodeAgent, HfApiModel

agent = CodeAgent(tools=[], model=HfApiModel())
alfred_agent = agent.from_hub('sergiopaniego/AlfredAgent', trust_remote_code=True)

alfred_agent.run("Give me the best playlist for a party at Wayne's mansion. The party idea is a 'villain masquerade' theme")
```
AlfredëŠ” ì‹¤í–‰ëœ ê²°ê³¼ë¥¼ Langfuse ëŒ€ì‹œë³´ë“œì—ì„œ ì—´ëŒí•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‚¬ì‹¤, ì´ ì‹¤í–‰ ì¤‘ ì‘ì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì§€ë§Œ, ì—ì´ì „íŠ¸ëŠ” ì—¬ì „íˆ ìœ íš¨í•œ ì‘ë‹µì„ ë°˜í™˜í–ˆìŠµë‹ˆë‹¤.
ğŸ‘‰ ì˜¤ë¥˜ë¥¼ ë¡œê·¸ì—ì„œ ì°¾ì•„ë³´ì„¸ìš”. ì—ì´ì „íŠ¸ê°€ ê·¸ ìƒí™©ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í–ˆëŠ”ì§€ ì¶”ì í•´ ë³´ì„¸ìš”.
ì§ì ‘ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´ ì˜¤ë¥˜ ë§í¬ë„ ìˆìŠµë‹ˆë‹¤. ë¬¼ë¡  ì§€ê¸ˆì€ ì˜¤ë¥˜ê°€ ìˆ˜ì •ë˜ì—ˆìœ¼ë©°, ìì„¸í•œ ë‚´ìš©ì€ í•´ë‹¹ issueì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

â¸»

ğŸ¶ ê·¸ ì™€ì¤‘ì— ì œì•ˆëœ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ëŠ” íŒŒí‹° ì¤€ë¹„ì— ì™„ë²½í•œ ë¶„ìœ„ê¸°ë¥¼ ë”í•´ì¤ë‹ˆë‹¤. ë©‹ì§€ì£ ?

â¸»

ì´ì œ ì²« ë²ˆì§¸ Code Agentë¥¼ ë§Œë“¤ì—ˆìœ¼ë‹ˆ, ë‹¤ìŒì€ Tool Calling Agent, smolagentsì—ì„œ ì œê³µí•˜ëŠ” ë‘ ë²ˆì§¸ ìœ í˜•ì˜ ì—ì´ì „íŠ¸ë¥¼ ë°°ì›Œë´…ì‹œë‹¤.

## ì½”ë“œ ìŠ¤ë‹ˆí« ë˜ëŠ” JSON ë¸”ë¡­ìœ¼ë¡œ ì‘ì—… ì‘ì„±í•˜ê¸°


`Tool Calling Agents`ëŠ” smolagentsì—ì„œ ì œê³µí•˜ëŠ” ë‘ ë²ˆì§¸ ìœ í˜•ì˜ ì—ì´ì „íŠ¸ì…ë‹ˆë‹¤.

Python ì½”ë“œ ìŠ¤ë‹ˆí«ì„ ì‚¬ìš©í•˜ëŠ” Code Agentì™€ ë‹¬ë¦¬, ì´ ì—ì´ì „íŠ¸ëŠ” LLM ì œê³µìì˜ ë‚´ì¥ëœ ë„êµ¬ í˜¸ì¶œ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ ë„êµ¬ í˜¸ì¶œì„ JSON êµ¬ì¡°ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

ì´ ë°©ì‹ì€ OpenAI, Anthropic, ê¸°íƒ€ ì—¬ëŸ¬ ì œê³µìë“¤ì´ ì‚¬ìš©í•˜ëŠ” í‘œì¤€ ë°©ì‹ì…ë‹ˆë‹¤.

â¸»

ì˜ˆë¥¼ ë“¤ì–´, Alfredê°€ ì¼€ì´í„°ë§ ì„œë¹„ìŠ¤ì™€ íŒŒí‹° ì•„ì´ë””ì–´ë¥¼ ê²€ìƒ‰í•˜ê³ ì í•  ë•Œ:

âœ… CodeAgentëŠ” ë‹¤ìŒê³¼ ê°™ì€ Python ì½”ë“œë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤:
```python
for query in [
    "Best catering services in Gotham City",
    "Party theme ideas for superheroes"
]:
    print(web_search(f"Search for: {query}"))
```
âœ… ë°˜ë©´, ToolCallingAgentëŠ” ë‹¤ìŒê³¼ ê°™ì€ JSON êµ¬ì¡°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:
```json
[
    {"name": "web_search", "arguments": "Best catering services in Gotham City"},
    {"name": "web_search", "arguments": "Party theme ideas for superheroes"}
]
```

ì´ JSON ë¸”ë¡­ì€ ë„êµ¬ í˜¸ì¶œì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

â¸»

smolagentsëŠ” `CodeAgent`ì— ì¤‘ì ì„ ë‘ê³  ìˆì§€ë§Œ, `ToolCallingAgent`ëŠ” ë³€ìˆ˜ ì²˜ë¦¬ë‚˜ ë³µì¡í•œ ë„êµ¬ í˜¸ì¶œì´ í•„ìš” ì—†ëŠ” ë‹¨ìˆœí•œ ì‹œìŠ¤í…œì— íš¨ê³¼ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

â¸»

### ğŸ§  ToolCallingAgentëŠ” ì–´ë–»ê²Œ ì‘ë™í• ê¹Œ?

ToolCallingAgentë„ CodeAgentì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë‹¤ë‹¨ê³„ ì›Œí¬í”Œë¡œìš°ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
ë‹¨ì§€ í–‰ë™ì„ JSON ê°ì²´ë¡œ êµ¬ì¡°í™”í•œë‹¤ëŠ” ì ë§Œ ë‹¤ë¦…ë‹ˆë‹¤. ì´ ê°ì²´ì—ëŠ” ë„êµ¬ ì´ë¦„ê³¼ ì¸ìê°€ í¬í•¨ë˜ë©°, ì‹œìŠ¤í…œì€ ì´ë¥¼ íŒŒì‹±í•´ ì ì ˆí•œ ë„êµ¬ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

â¸»

ì˜ˆì œ: ToolCallingAgent ì‹¤í–‰

Alfredê°€ íŒŒí‹° ì¤€ë¹„ë¥¼ ì‹œì‘í–ˆë˜ ì´ì „ ì˜ˆì œë¥¼ ë‹¤ì‹œ ì‚´í´ë³´ë˜, ì´ë²ˆì—” ToolCallingAgentë¥¼ ì‚¬ìš©í•´ ë´…ì‹œë‹¤. DuckDuckGoë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ëŠ” ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.
```python
from smolagents import ToolCallingAgent, DuckDuckGoSearchTool, HfApiModel

agent = ToolCallingAgent(
    tools=[DuckDuckGoSearchTool()],
    model=HfApiModel()
)

agent.run("Search for the best music recommendations for a party at the Wayne's mansion.")
```
ì´ ì—ì´ì „íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³  ì¶”ì  ë¡œê·¸ë¥¼ ë³´ë©´, Executing parsed code: ëŒ€ì‹  ë‹¤ìŒê³¼ ê°™ì€ ì¶œë ¥ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤:
```shell
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Calling tool: 'web_search' with arguments: {'query': "best music recommendations for a party at Wayne's mansion"} â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```
ToolCallingAgentëŠ” ì½”ë“œë¥¼ ì§ì ‘ ì‹¤í–‰í•˜ëŠ” ëŒ€ì‹ , êµ¬ì¡°í™”ëœ ë„êµ¬ í˜¸ì¶œì„ ìƒì„±í•˜ê³  ì‹œìŠ¤í…œì´ ì´ë¥¼ ì²˜ë¦¬í•˜ì—¬ ê²°ê³¼ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

â¸»

ì´ì œ ë‘ ê°€ì§€ ì—ì´ì „íŠ¸ ìœ í˜•ì„ ì´í•´í–ˆìœ¼ë‹ˆ, í•„ìš”í•œ ìƒí™©ì— ë§ê²Œ ì ì ˆí•œ ìœ í˜•ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê³„ì†í•´ì„œ smolagentsë¥¼ íƒìƒ‰í•˜ë©° Alfredì˜ íŒŒí‹°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì¤€ë¹„í•´ë´…ì‹œë‹¤! ğŸ‰



## Tools

Unit 1ì—ì„œ ì‚´í´ë³¸ ê²ƒì²˜ëŸ¼, ì—ì´ì „íŠ¸ëŠ” ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ë„êµ¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
smolagentsì—ì„œëŠ” ë„êµ¬ë¥¼ LLMì´ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¡œ ê°„ì£¼í•˜ë©°, ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ ë‚´ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.

LLMì´ ë„êµ¬ì™€ ìƒí˜¸ì‘ìš©í•˜ë ¤ë©´, ë‹¤ìŒê³¼ ê°™ì€ í•µì‹¬ ìš”ì†Œë¥¼ í¬í•¨í•œ ì¸í„°í˜ì´ìŠ¤ ì„¤ëª…ì´ í•„ìš”í•©ë‹ˆë‹¤:
- ì´ë¦„ (Name): ë„êµ¬ì˜ ì´ë¦„
- ë„êµ¬ ì„¤ëª… (Tool description): ì´ ë„êµ¬ê°€ ì–´ë–¤ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ”ì§€
- ì…ë ¥ íƒ€ì… ë° ì„¤ëª… (Input types and descriptions): ë„êµ¬ê°€ ì–´ë–¤ ì¸ìë¥¼ ë°›ëŠ”ì§€
- ì¶œë ¥ íƒ€ì… (Output type): ë„êµ¬ê°€ ì–´ë–¤ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ”ì§€

â¸»

ì˜ˆë¥¼ ë“¤ì–´, Alfredê°€ Wayne ì €íƒì—ì„œ ì—´ë¦´ íŒŒí‹°ë¥¼ ì¤€ë¹„í•˜ë©´ì„œ ì¼€ì´í„°ë§ ì„œë¹„ìŠ¤ë¥¼ ì°¾ê±°ë‚˜ íŒŒí‹° í…Œë§ˆ ì•„ì´ë””ì–´ë¥¼ ê²€ìƒ‰í•˜ë ¤ë©´ ë‹¤ì–‘í•œ ì •ë³´ ìˆ˜ì§‘ ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.
ë‹¤ìŒì€ ê°„ë‹¨í•œ ì›¹ ê²€ìƒ‰ ë„êµ¬ ì¸í„°í˜ì´ìŠ¤ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤:
- ì´ë¦„: web_search
- ë„êµ¬ ì„¤ëª…: íŠ¹ì • ì¿¼ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì›¹ì„ ê²€ìƒ‰
- ì…ë ¥: query (string) â€“ ê²€ìƒ‰í•  í‚¤ì›Œë“œ
- ì¶œë ¥: ê²€ìƒ‰ ê²°ê³¼ë¥¼ í¬í•¨í•œ ë¬¸ìì—´

â¸»

ì´ëŸ¬í•œ ë„êµ¬ë“¤ì„ í™œìš©í•¨ìœ¼ë¡œì¨ AlfredëŠ” ì •ë³´ì— ê¸°ë°˜í•œ ì˜ì‚¬ê²°ì •ì„ ë‚´ë¦¬ê³ , ì™„ë²½í•œ íŒŒí‹°ë¥¼ ê¸°íší•˜ëŠ” ë° í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì•„ë˜ì—ëŠ” ë„êµ¬ í˜¸ì¶œì´ ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ì§€ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ì• ë‹ˆë©”ì´ì…˜ì´ ë‚˜ì˜µë‹ˆë‹¤:

![alt text](Agent_ManimCE.gif)


### ë„êµ¬ ìƒì„± ë°©ë²•

smolagentsì—ì„œëŠ” ë„êµ¬(tool)ë¥¼ ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
1. @tool ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê°„ë‹¨í•œ í•¨ìˆ˜ ê¸°ë°˜ ë„êµ¬
2. Tool í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì•„ ë” ë³µì¡í•œ ê¸°ëŠ¥ì„ ê°€ì§„ ë„êµ¬ë¥¼ ìƒì„±

â¸»

âœ… @tool ë°ì½”ë ˆì´í„°

@tool ë°ì½”ë ˆì´í„°ëŠ” ê°„ë‹¨í•œ ë„êµ¬ë¥¼ ì •ì˜í•  ë•Œ ê¶Œì¥ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
smolagentsëŠ” Python í•¨ìˆ˜ë¡œë¶€í„° ê¸°ë³¸ ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ íŒŒì‹±í•˜ë¯€ë¡œ,
- í•¨ìˆ˜ ì´ë¦„ì„ ëª…í™•í•˜ê²Œ ì •í•˜ê³ ,
- ì¢‹ì€ docstringì„ ì‘ì„±í•˜ë©´
LLMì´ ë„êµ¬ë¥¼ ë” ì˜ ì´í•´í•˜ê³  ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

â¸»

ì´ ë°©ì‹ìœ¼ë¡œ ë„êµ¬ë¥¼ ì •ì˜í•  ë•ŒëŠ” ë‹¤ìŒì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:
- ëª…í™•í•˜ê³  ì„¤ëª…ì ì¸ í•¨ìˆ˜ ì´ë¦„ â€“ LLMì´ ëª©ì ì„ íŒŒì•…í•  ìˆ˜ ìˆê²Œ
- ì…ë ¥ ë° ì¶œë ¥ì— ëŒ€í•œ íƒ€ì… íŒíŠ¸ â€“ ì˜¬ë°”ë¥¸ ì‚¬ìš© ë³´ì¥
- ìì„¸í•œ docstring â€“ íŠ¹íˆ Args: ì„¹ì…˜ì—ì„œ ê° ì¸ìë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì„¤ëª…
(ì´ ì„¤ëª…ì€ LLMì—ê²Œ ì¤‘ìš”í•œ ë¬¸ë§¥ ì •ë³´ë¥¼ ì œê³µí•˜ë¯€ë¡œ ì‹ ì¤‘í•˜ê²Œ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤)


Alfredê°€ ì´ë¯¸ íŒŒí‹° ë©”ë‰´ë¥¼ ê²°ì •í–ˆì§€ë§Œ, ë§ì€ ì†ë‹˜ì„ ìœ„í•œ ìŒì‹ ì¤€ë¹„ê°€ í•„ìš”í•˜ë‹¤ê³  ìƒìƒí•´ ë´…ì‹œë‹¤.

ì´ë¥¼ ìœ„í•´ ê·¸ëŠ” ì¼€ì´í„°ë§ ì„œë¹„ìŠ¤ë¥¼ ê³ ìš©í•˜ê³ ì í•˜ë©°, ê°€ì¥ í‰ì ì´ ë†’ì€ ì—…ì²´ë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.

AlfredëŠ” ë„êµ¬ë¥¼ í™œìš©í•´ ìì‹ ì˜ ì§€ì—­ì—ì„œ ìµœê³ ì˜ ì¼€ì´í„°ë§ ì„œë¹„ìŠ¤ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from smolagents import CodeAgent, HfApiModel, tool

# Let's pretend we have a function that fetches the highest-rated catering services.

def catering_service_tool(query: str) -> str:
    """
    This tool returns the highest-rated catering service in Gotham City.

    Args:
        query: A search term for finding catering services.
    """
    # Example list of catering services and their ratings
    services = {
        "Gotham Catering Co.": 4.9,
        "Wayne Manor Catering": 4.8,
        "Gotham City Events": 4.7,
    }

    # Find the highest rated catering service (simulating search query filtering)
    best_service = max(services, key=services.get)

    return best_service


agent = CodeAgent(tools=[catering_service_tool], model=HfApiModel())

# Run the agent to find the best catering service
result = agent.run(
    "Can you give me the name of the highest-rated catering service in Gotham City?"
)

print(result)   # Output: Gotham Catering Co.
```

### Python í´ë˜ìŠ¤ í˜•íƒœë¡œ ë„êµ¬ ì •ì˜í•˜ê¸°

ì´ ë°©ì‹ì€ Toolì„ ìƒì†ë°›ì•„ ì„œë¸Œí´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ë³µì¡í•œ ë„êµ¬ì˜ ê²½ìš°, Python í•¨ìˆ˜ ëŒ€ì‹  í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í´ë˜ìŠ¤ëŠ” LLMì´ ë„êµ¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë©”íƒ€ë°ì´í„°ë¡œ í•¨ìˆ˜ ê¸°ëŠ¥ì„ ê°ìŒ‰ë‹ˆë‹¤.

ì´ í´ë˜ìŠ¤ì—ì„œëŠ” ë‹¤ìŒì„ ì •ì˜í•©ë‹ˆë‹¤:
- name: ë„êµ¬ì˜ ì´ë¦„
- description: ì—ì´ì „íŠ¸ì˜ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì— í¬í•¨ë  ë„êµ¬ ì„¤ëª…
- inputs: typeê³¼ description í‚¤ë¥¼ ê°€ì§€ëŠ” ë”•ì…”ë„ˆë¦¬ë¡œ, Python ì¸í„°í”„ë¦¬í„°ê°€ ì…ë ¥ì„ ì²˜ë¦¬í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ì •ë³´ ì œê³µ
- output_type: ì˜ˆìƒë˜ëŠ” ì¶œë ¥ íƒ€ì… ì§€ì •
- forward: ì‹¤í–‰í•  ì¶”ë¡  ë¡œì§ì´ í¬í•¨ëœ ë©”ì„œë“œ

ì•„ë˜ëŠ” Toolì„ ì‚¬ìš©í•´ êµ¬ì¶•ëœ ë„êµ¬ì˜ ì˜ˆì‹œì™€ ì´ë¥¼ CodeAgentì— í†µí•©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

â¸»

ìŠˆí¼íˆì–´ë¡œ í…Œë§ˆ íŒŒí‹°ì— ëŒ€í•œ ì•„ì´ë””ì–´ë¥¼ ìƒì„±í•˜ëŠ” ë„êµ¬ ë§Œë“¤ê¸°
Alfredê°€ ì €íƒì—ì„œ ì—¬ëŠ” íŒŒí‹°ëŠ” ìŠˆí¼íˆì–´ë¡œë¥¼ í…Œë§ˆë¡œ í•œ ì´ë²¤íŠ¸ì´ì§€ë§Œ, ê·¸ë¥¼ ì •ë§ íŠ¹ë³„í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ê°€ í•„ìš”í•©ë‹ˆë‹¤.
í›Œë¥­í•œ í˜¸ìŠ¤íŠ¸ì¸ ê·¸ëŠ” ì†ë‹˜ë“¤ì„ ë…ì°½ì ì¸ í…Œë§ˆë¡œ ë†€ë¼ê²Œ í•˜ê³  ì‹¶ì–´ í•©ë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ AlfredëŠ” ì£¼ì–´ì§„ ì¹´í…Œê³ ë¦¬ì— ë”°ë¼ ìŠˆí¼íˆì–´ë¡œ í…Œë§ˆ íŒŒí‹° ì•„ì´ë””ì–´ë¥¼ ìƒì„±í•˜ëŠ” ì—ì´ì „íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì´ë ‡ê²Œ í•˜ë©´ ì†ë‹˜ë“¤ì„ ê°íƒ„í•˜ê²Œ ë§Œë“¤ ì™„ë²½í•œ íŒŒí‹° í…Œë§ˆë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from smolagents import Tool, CodeAgent, HfApiModel

class SuperheroPartyThemeTool(Tool):
    name = "superhero_party_theme_generator"
    description = """
    This tool suggests creative superhero-themed party ideas based on a category.
    It returns a unique party theme idea."""

    inputs = {
        "category": {
            "type": "string",
            "description": "The type of superhero party (e.g., 'classic heroes', 'villain masquerade', 'futuristic Gotham').",
        }
    }

    output_type = "string"

    def forward(self, category: str):
        themes = {
            "classic heroes": "Justice League Gala: Guests come dressed as their favorite DC heroes with themed cocktails like 'The Kryptonite Punch'.",
            "villain masquerade": "Gotham Rogues' Ball: A mysterious masquerade where guests dress as classic Batman villains.",
            "futuristic Gotham": "Neo-Gotham Night: A cyberpunk-style party inspired by Batman Beyond, with neon decorations and futuristic gadgets."
        }

        return themes.get(category.lower(), "Themed party idea not found. Try 'classic heroes', 'villain masquerade', or 'futuristic Gotham'.")

# Instantiate the tool
party_theme_tool = SuperheroPartyThemeTool()
agent = CodeAgent(tools=[party_theme_tool], model=HfApiModel())

# Run the agent to generate a party theme idea
result = agent.run(
    "What would be a good superhero party idea for a 'villain masquerade' theme?"
)

print(result)  # Output: "Gotham Rogues' Ball: A mysterious masquerade where guests dress as classic Batman villains."
```

### ê¸°ë³¸ ë„êµ¬ ìƒì (Default Toolbox)
smolagentsì—ëŠ” ì—ì´ì „íŠ¸ì— ë°”ë¡œ ì£¼ì…í•  ìˆ˜ ìˆëŠ” ì‚¬ì „ êµ¬ì¶•ëœ ë„êµ¬ ì„¸íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ ë„êµ¬ ìƒìì—ëŠ” ë‹¤ìŒì´ í¬í•¨ë©ë‹ˆë‹¤:
- PythonInterpreterTool
- FinalAnswerTool
- UserInputTool
- DuckDuckGoSearchTool
- GoogleSearchTool
- VisitWebpageTool

AlfredëŠ” Wayne ì €íƒì—ì„œ ì™„ë²½í•œ íŒŒí‹°ë¥¼ ì—´ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ë„êµ¬ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ë¨¼ì €, **DuckDuckGoSearchTool**ì„ ì‚¬ìš©í•´ ì°½ì˜ì ì¸ ìŠˆí¼íˆì–´ë¡œ í…Œë§ˆ íŒŒí‹° ì•„ì´ë””ì–´ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì¼€ì´í„°ë§ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•´ì„œëŠ” **GoogleSearchTool**ì„ ì´ìš©í•´ ê³ ë‹´ì—ì„œ í‰ì ì´ ê°€ì¥ ë†’ì€ ì—…ì²´ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
- ì¢Œì„ ë°°ì¹˜ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ì„œëŠ” **PythonInterpreterTool**ë¡œ ê³„ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ëª¨ë“  ì •ë³´ë¥¼ ìˆ˜ì§‘í•œ í›„ì—ëŠ” **FinalAnswerTool**ì„ ì‚¬ìš©í•´ ê³„íšì„ ì •ë¦¬í•©ë‹ˆë‹¤.

ì´ ë„êµ¬ë“¤ì„ í™œìš©í•˜ë©´, AlfredëŠ” ì™„ë²½í•˜ê³  ë§¤ë„ëŸ¬ìš´ íŒŒí‹°ë¥¼ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ¦‡ğŸ’¡

### LangChain ë„êµ¬ ê°€ì ¸ì˜¤ê¸°

LangChain í”„ë ˆì„ì›Œí¬ì— ëŒ€í•´ì„œëŠ” ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ë‹¤ë£° ì˜ˆì •ì…ë‹ˆë‹¤.

ì§€ê¸ˆì€ smolagents ì›Œí¬í”Œë¡œìš°ì—ì„œ LangChain ë„êµ¬ë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì ë§Œ ì•Œì•„ë‘ë©´ ë©ë‹ˆë‹¤!

LangChain ë„êµ¬ëŠ” Tool.from_langchain() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê°„í¸í•˜ê²Œ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

AlfredëŠ” ì™„ë²½ì£¼ì˜ìë‹µê²Œ, Waynesê°€ ìë¦¬ë¥¼ ë¹„ìš´ ì‚¬ì´ ì €íƒì—ì„œ ì—´ë¦´ í™”ë ¤í•œ ìŠˆí¼íˆì–´ë¡œ ë‚˜ì´íŠ¸ë¥¼ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ëª¨ë“  ì„¸ë¶€ ì‚¬í•­ì´ ê¸°ëŒ€ë¥¼ ë›°ì–´ë„˜ë„ë¡ í•˜ê¸° ìœ„í•´, ê·¸ëŠ” LangChain ë„êµ¬ë¥¼ í™œìš©í•˜ì—¬ ìµœê³ ê¸‰ ì—”í„°í…Œì¸ë¨¼íŠ¸ ì•„ì´ë””ì–´ë¥¼ ì°¾ì•„ëƒ…ë‹ˆë‹¤.

Tool.from_langchain()ì„ ì‚¬ìš©í•˜ë©´ AlfredëŠ” ê³ ê¸‰ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ìì‹ ì˜ smolagentì— ì†ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆìœ¼ë©°, ë‹¨ ëª‡ ê°œì˜ ëª…ë ¹ë§Œìœ¼ë¡œ íŠ¹ë³„í•œ íŒŒí‹° ì•„ì´ë””ì–´ì™€ ì„œë¹„ìŠ¤ë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ Alfredê°€ ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤:

```python
from langchain.agents import load_tools
from smolagents import CodeAgent, HfApiModel, Tool

search_tool = Tool.from_langchain(load_tools(["serpapi"])[0])

agent = CodeAgent(tools=[search_tool], model=model)

agent.run("Search for luxury entertainment ideas for a superhero-themed event, such as live performances and interactive experiences.")
```


## ì—ì´ì „í‹± RAG ì‹œìŠ¤í…œ êµ¬ì¶•í•˜ê¸°

ê²€ìƒ‰ ì¦ê°• ìƒì„±(Retrieval Augmented Generation, RAG) ì‹œìŠ¤í…œì€ ë°ì´í„° ê²€ìƒ‰ê³¼ ìƒì„± ëª¨ë¸ì˜ ê¸°ëŠ¥ì„ ê²°í•©í•˜ì—¬ ë¬¸ë§¥ ì¸ì‹ ì‘ë‹µì„ ì œê³µí•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìì˜ ì¿¼ë¦¬ë¥¼ ê²€ìƒ‰ ì—”ì§„ì— ì „ë‹¬í•˜ê³ , ê²€ìƒ‰ëœ ê²°ê³¼ë¥¼ ëª¨ë¸ì— ì¿¼ë¦¬ì™€ í•¨ê»˜ ì œê³µí•˜ì—¬ ëª¨ë¸ì´ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤.

**ì—ì´ì „í‹± RAG(Agentic RAG)**ëŠ” ììœ¨ ì—ì´ì „íŠ¸ì™€ ë™ì  ì§€ì‹ ê²€ìƒ‰ì„ ê²°í•©í•˜ì—¬ ì „í†µì ì¸ RAG ì‹œìŠ¤í…œì„ í™•ì¥í•©ë‹ˆë‹¤.

ì „í†µì ì¸ RAG ì‹œìŠ¤í…œì€ ê²€ìƒ‰ëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¿¼ë¦¬ì— ë‹µë³€í•˜ê¸° ìœ„í•´ LLMì„ ì‚¬ìš©í•˜ì§€ë§Œ, ì—ì´ì „í‹± RAGëŠ” ê²€ìƒ‰ê³¼ ìƒì„± í”„ë¡œì„¸ìŠ¤ë¥¼ ëª¨ë‘ ì§€ëŠ¥ì ìœ¼ë¡œ ì œì–´í•˜ì—¬ íš¨ìœ¨ì„±ê³¼ ì •í™•ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

ì „í†µì ì¸ RAG ì‹œìŠ¤í…œì€ ë‹¨ì¼ ê²€ìƒ‰ ë‹¨ê³„ì— ì˜ì¡´í•˜ê³ , ì‚¬ìš©ìì˜ ì¿¼ë¦¬ì™€ ì§ì ‘ì ì¸ ì˜ë¯¸ì  ìœ ì‚¬ì„±ì— ì´ˆì ì„ ë§ì¶”ëŠ” ë“±ì˜ ì£¼ìš” í•œê³„ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì ‘ê·¼ ë°©ì‹ì€ ê´€ë ¨ ì •ë³´ë¥¼ ê°„ê³¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì—ì´ì „í‹± RAGëŠ” ì—ì´ì „íŠ¸ê°€ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ììœ¨ì ìœ¼ë¡œ ì‘ì„±í•˜ê³ , ê²€ìƒ‰ëœ ê²°ê³¼ë¥¼ ë¹„íŒì ìœ¼ë¡œ í‰ê°€í•˜ë©°, ë³´ë‹¤ ë§ì¶¤í™”ë˜ê³  í¬ê´„ì ì¸ ì¶œë ¥ì„ ìœ„í•´ ì—¬ëŸ¬ ë²ˆì˜ ê²€ìƒ‰ ë‹¨ê³„ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•¨ìœ¼ë¡œì¨ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.

DuckDuckGoë¥¼ í™œìš©í•œ ê¸°ë³¸ ê²€ìƒ‰

DuckDuckGoë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ ì—ì´ì „íŠ¸ëŠ” ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ê³  ì‘ë‹µì„ í•©ì„±í•˜ì—¬ ì¿¼ë¦¬ì— ë‹µë³€í•©ë‹ˆë‹¤. ì—ì´ì „í‹± RAGë¥¼ í†µí•´ Alfredì˜ ì—ì´ì „íŠ¸ëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ìµœì‹  ìŠˆí¼íˆì–´ë¡œ íŒŒí‹° íŠ¸ë Œë“œ ê²€ìƒ‰
- ê²°ê³¼ë¥¼ ì„¸ë ¨ëœ ìš”ì†Œë¡œ ì„¸ë¶„í™”
- ì •ë³´ë¥¼ ì¢…í•©í•˜ì—¬ ì™„ì „í•œ ê³„íš ìˆ˜ë¦½

Alfredì˜ ì—ì´ì „íŠ¸ê°€ ì´ë¥¼ ì–´ë–»ê²Œ ë‹¬ì„±í•  ìˆ˜ ìˆëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:
```python
from smolagents import CodeAgent, DuckDuckGoSearchTool, HfApiModel

# ê²€ìƒ‰ ë„êµ¬ ì´ˆê¸°í™”
search_tool = DuckDuckGoSearchTool()

# ëª¨ë¸ ì´ˆê¸°í™”
model = HfApiModel()

agent = CodeAgent(
    model=model,
    tools=[search_tool]
)

# ì‚¬ìš© ì˜ˆì‹œ
response = agent.run(
    "ëŸ­ì…”ë¦¬ ìŠˆí¼íˆì–´ë¡œ í…Œë§ˆ íŒŒí‹° ì•„ì´ë””ì–´ë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”. ì¥ì‹, ì—”í„°í…Œì¸ë¨¼íŠ¸, ì¼€ì´í„°ë§ì„ í¬í•¨í•˜ì—¬."
)
print(response)
```
ì—ì´ì „íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ ë”°ë¦…ë‹ˆë‹¤:
1. ìš”ì²­ ë¶„ì„: Alfredì˜ ì—ì´ì „íŠ¸ëŠ” ì¿¼ë¦¬ì˜ í•µì‹¬ ìš”ì†Œì¸ ëŸ­ì…”ë¦¬ ìŠˆí¼íˆì–´ë¡œ í…Œë§ˆ íŒŒí‹° ê¸°íšì„ ì‹ë³„í•˜ë©°, ì¥ì‹, ì—”í„°í…Œì¸ë¨¼íŠ¸, ì¼€ì´í„°ë§ì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.
2. ê²€ìƒ‰ ìˆ˜í–‰: ì—ì´ì „íŠ¸ëŠ” DuckDuckGoë¥¼ í™œìš©í•˜ì—¬ ê°€ì¥ ê´€ë ¨ì„± ë†’ê³  ìµœì‹  ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ë©°, Alfredì˜ ì„¸ë ¨ëœ ì´ë²¤íŠ¸ ì„ í˜¸ë„ì— ë¶€í•©í•˜ë„ë¡ í•©ë‹ˆë‹¤.
3. ì •ë³´ ì¢…í•©: ê²€ìƒ‰ëœ ê²°ê³¼ë¥¼ ìˆ˜ì§‘í•œ í›„, ì—ì´ì „íŠ¸ëŠ” ì´ë¥¼ Alfredë¥¼ ìœ„í•œ ì¼ê´€ë˜ê³  ì‹¤í–‰ ê°€ëŠ¥í•œ íŒŒí‹° ê³„íšìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
4. ë¯¸ë˜ ì°¸ì¡°ë¥¼ ìœ„í•œ ì €ì¥: ì—ì´ì „íŠ¸ëŠ” ê²€ìƒ‰ëœ ì •ë³´ë¥¼ ì €ì¥í•˜ì—¬ í–¥í›„ ì´ë²¤íŠ¸ ê³„íš ì‹œ ì‰½ê²Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬, ì´í›„ ì‘ì—…ì˜ íš¨ìœ¨ì„±ì„ ìµœì í™”í•©ë‹ˆë‹¤.

###  ë§ì¶¤í˜• ì§€ì‹ ë² ì´ìŠ¤ ë„êµ¬

íŠ¹ìˆ˜í•œ ì‘ì—…ì˜ ê²½ìš°, ë§ì¶¤í˜• ì§€ì‹ ë² ì´ìŠ¤ê°€ ë§¤ìš° ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ìˆ  ë¬¸ì„œë‚˜ ì „ë¬¸ ì§€ì‹ì˜ ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¿¼ë¦¬í•˜ëŠ” ë„êµ¬ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

ì˜ë¯¸ì  ê²€ìƒ‰ì„ ì‚¬ìš©í•˜ì—¬ ì—ì´ì „íŠ¸ëŠ” Alfredì˜ ìš”êµ¬ì— ê°€ì¥ ê´€ë ¨ì„± ë†’ì€ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ëŠ” í…ìŠ¤íŠ¸ë‚˜ ê¸°íƒ€ ë°ì´í„°ì˜ ìˆ˜ì¹˜ì  í‘œí˜„(ì„ë² ë”©)ì„ ì €ì¥í•˜ë©°, ì´ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì— ì˜í•´ ìƒì„±ë©ë‹ˆë‹¤.

ì´ë¥¼ í†µí•´ ì˜ë¯¸ì  ê²€ìƒ‰ì´ ê°€ëŠ¥í•˜ë©°, ê³ ì°¨ì› ê³µê°„ì—ì„œ ìœ ì‚¬í•œ ì˜ë¯¸ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ ì ‘ê·¼ ë°©ì‹ì€ ì‚¬ì „ ì •ì˜ëœ ì§€ì‹ê³¼ ì˜ë¯¸ì  ê²€ìƒ‰ì„ ê²°í•©í•˜ì—¬ Alfredì˜ ìš”êµ¬ì— ë§ëŠ” í¬ê´„ì ì´ê³  ì •í™•í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```python
from langchain.docstore.document import Document
from langchain.text_splitter import RecursiveCharacterTextSplitter
from smolagents import Tool
from langchain_community.retrievers import BM25Retriever
from smolagents import CodeAgent, HfApiModel

class PartyPlanningRetrieverTool(Tool):
    name = "party_planning_retriever"
    description = "Uses semantic search to retrieve relevant party planning ideas for Alfredâ€™s superhero-themed party at Wayne Manor."
    inputs = {
        "query": {
            "type": "string",
            "description": "The query to perform. This should be a query related to party planning or superhero themes.",
        }
    }
    output_type = "string"

    def __init__(self, docs, **kwargs):
        super().__init__(**kwargs)
        self.retriever = BM25Retriever.from_documents(
            docs, k=5  # Retrieve the top 5 documents
        )

    def forward(self, query: str) -> str:
        assert isinstance(query, str), "Your search query must be a string"

        docs = self.retriever.invoke(
            query,
        )
        return "\nRetrieved ideas:\n" + "".join(
            [
                f"\n\n===== Idea {str(i)} =====\n" + doc.page_content
                for i, doc in enumerate(docs)
            ]
        )

# Simulate a knowledge base about party planning
party_ideas = [
    {"text": "A superhero-themed masquerade ball with luxury decor, including gold accents and velvet curtains.", "source": "Party Ideas 1"},
    {"text": "Hire a professional DJ who can play themed music for superheroes like Batman and Wonder Woman.", "source": "Entertainment Ideas"},
    {"text": "For catering, serve dishes named after superheroes, like 'The Hulk's Green Smoothie' and 'Iron Man's Power Steak.'", "source": "Catering Ideas"},
    {"text": "Decorate with iconic superhero logos and projections of Gotham and other superhero cities around the venue.", "source": "Decoration Ideas"},
    {"text": "Interactive experiences with VR where guests can engage in superhero simulations or compete in themed games.", "source": "Entertainment Ideas"}
]

source_docs = [
    Document(page_content=doc["text"], metadata={"source": doc["source"]})
    for doc in party_ideas
]

# Split the documents into smaller chunks for more efficient search
text_splitter = RecursiveCharacterTextSplitter(
    chunk_size=500,
    chunk_overlap=50,
    add_start_index=True,
    strip_whitespace=True,
    separators=["\n\n", "\n", ".", " ", ""],
)
docs_processed = text_splitter.split_documents(source_docs)

# Create the retriever tool
party_planning_retriever = PartyPlanningRetrieverTool(docs_processed)

# Initialize the agent
agent = CodeAgent(tools=[party_planning_retriever], model=HfApiModel())

# Example usage
response = agent.run(
    "Find ideas for a luxury superhero-themed party, including entertainment, catering, and decoration options."
)

print(response)
```

ì´ í–¥ìƒëœ ì—ì´ì „íŠ¸ëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ë¨¼ì € ë¬¸ì„œë¥¼ í™•ì¸í•˜ì—¬ ê´€ë ¨ ì •ë³´ë¥¼ ì°¾ìŒ
- ì§€ì‹ ë² ì´ìŠ¤ì—ì„œ ì–»ì€ ì¸ì‚¬ì´íŠ¸ë¥¼ ê²°í•©
- ëŒ€í™” ë¬¸ë§¥ì„ ë©”ëª¨ë¦¬ì— ìœ ì§€

â¸»

í–¥ìƒëœ ê²€ìƒ‰ ê¸°ëŠ¥

ì—ì´ì „í‹± RAG ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ë•Œ, ì—ì´ì „íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì •êµí•œ ì „ëµì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ì¿¼ë¦¬ ì¬ì‘ì„±(Query Reformulation): ì‚¬ìš©ì ì¿¼ë¦¬ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹ , ëŒ€ìƒ ë¬¸ì„œì— ë” ì˜ ë§ëŠ” ìµœì í™”ëœ ê²€ìƒ‰ì–´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŒ
- ë‹¤ë‹¨ê³„ ê²€ìƒ‰(Multi-Step Retrieval): ì´ˆê¸° ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ í›„ì† ì¿¼ë¦¬ë¥¼ êµ¬ì„±í•˜ë©°, ì—¬ëŸ¬ ë²ˆ ê²€ìƒ‰ ìˆ˜í–‰
- ì†ŒìŠ¤ í†µí•©(Source Integration): ì›¹ ê²€ìƒ‰, ë¡œì»¬ ë¬¸ì„œ ë“± ë‹¤ì–‘í•œ ì¶œì²˜ì˜ ì •ë³´ë¥¼ ê²°í•© ê°€ëŠ¥
- ê²°ê³¼ ê²€ì¦(Result Validation): ê²€ìƒ‰ëœ ì½˜í…ì¸ ê°€ ì‘ë‹µì— í¬í•¨ë˜ê¸° ì „ì— ê´€ë ¨ì„±ê³¼ ì •í™•ì„±ì„ ë¶„ì„í•¨

â¸»

íš¨ê³¼ì ì¸ ì—ì´ì „í‹± RAG ì‹œìŠ¤í…œì„ ìœ„í•´ì„œëŠ” ì—¬ëŸ¬ í•µì‹¬ ìš”ì†Œë“¤ì„ ì‹ ì¤‘í•˜ê²Œ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. ì—ì´ì „íŠ¸ëŠ” ì¿¼ë¦¬ ìœ í˜•ê³¼ ë¬¸ë§¥ì— ë”°ë¼ ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬ ì¤‘ì—ì„œ ì„ íƒí•´ì•¼ í•˜ë©°, ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œì€ ëŒ€í™” ì´ë ¥ì„ ìœ ì§€í•˜ê³  ë°˜ë³µ ê²€ìƒ‰ì„ í”¼í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ë°±ì—… ì „ëµ(fallback strategy)ì„ ê°–ì¶”ë©´ ì£¼ìš” ê²€ìƒ‰ ë°©ì‹ì´ ì‹¤íŒ¨í•´ë„ ì‹œìŠ¤í…œì´ ì—¬ì „íˆ ìœ ìš©í•œ ì¶œë ¥ì„ ì œê³µí•  ìˆ˜ ìˆìœ¼ë©°, ê²€ì¦ ë‹¨ê³„ë¥¼ êµ¬í˜„í•˜ë©´ ê²€ìƒ‰ëœ ì •ë³´ì˜ ì •í™•ì„±ê³¼ ê´€ë ¨ì„±ì„ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


Agentic RAG: turbocharge your RAG with query reformulation and self-query! ğŸš€ - Recipe for developing an Agentic RAG system using smolagents.


## Multi Agent systems

ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ

ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì€ ì „ë¬¸í™”ëœ ì—ì´ì „íŠ¸ë“¤ì´ ë³µì¡í•œ ì‘ì—…ì— ëŒ€í•´ í˜‘ë ¥í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ëª¨ë“ˆì„±, í™•ì¥ì„± ë° ê²¬ê³ ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤. ë‹¨ì¼ ì—ì´ì „íŠ¸ì— ì˜ì¡´í•˜ëŠ” ëŒ€ì‹ , ì„œë¡œ ë‹¤ë¥¸ ëŠ¥ë ¥ì„ ê°€ì§„ ì—¬ëŸ¬ ì—ì´ì „íŠ¸ë“¤ì´ ì‘ì—…ì„ ë¶„ì‚°í•˜ì—¬ ìˆ˜í–‰í•©ë‹ˆë‹¤.

smolagentsì—ì„œëŠ” ë‹¤ì–‘í•œ ì—ì´ì „íŠ¸ë“¤ì„ ê²°í•©í•˜ì—¬ Python ì½”ë“œ ìƒì„±, ì™¸ë¶€ ë„êµ¬ í˜¸ì¶œ, ì›¹ ê²€ìƒ‰ ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì—ì´ì „íŠ¸ë“¤ì„ ì¡°í•©í•˜ì—¬ ê°•ë ¥í•œ ì›Œí¬í”Œë¡œìš°ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¼ë°˜ì ì¸ êµ¬ì„± ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
	â€¢	ì‘ì—…ì„ ìœ„ì„í•˜ëŠ” ë§¤ë‹ˆì € ì—ì´ì „íŠ¸
	â€¢	ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì½”ë“œ ì¸í„°í”„ë¦¬í„° ì—ì´ì „íŠ¸
	â€¢	ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ëŠ” ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸

ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì€ ë§¤ë‹ˆì € ì—ì´ì „íŠ¸ê°€ ì½”ë“œ ì¸í„°í”„ë¦¬í„° ë„êµ¬ì™€ ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸ë¥¼ ì¡°ì •í•˜ëŠ” ê°„ë‹¨í•œ ë©€í‹° ì—ì´ì „íŠ¸ ì•„í‚¤í…ì²˜ë¥¼ ë‚˜íƒ€ë‚´ë©°, ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸ëŠ” DuckDuckGoSearchTool ë° VisitWebpageToolê³¼ ê°™ì€ ë„êµ¬ë¥¼ í™œìš©í•˜ì—¬ ê´€ë ¨ ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.

![alt text](image-6.png)


ì‹¤ì œ ë™ì‘í•˜ëŠ” ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ

ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì€ ì—¬ëŸ¬ ì „ë¬¸í™”ëœ ì—ì´ì „íŠ¸ë“¤ì´ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ì—ì´ì „íŠ¸ì˜ ì¡°ì • í•˜ì— í˜‘ë ¥í•˜ì—¬ ì‘ì—…í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì ‘ê·¼ë²•ì€ ì„œë¡œ ë‹¤ë¥¸ ì—­í• ì„ ê°€ì§„ ì—ì´ì „íŠ¸ë“¤ ê°„ì— ì‘ì—…ì„ ë¶„ì‚°í•¨ìœ¼ë¡œì¨ ë³µì¡í•œ ì›Œí¬í”Œë¡œìš°ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ë©€í‹° ì—ì´ì „íŠ¸ RAG ì‹œìŠ¤í…œì€ ë‹¤ìŒê³¼ ê°™ì€ ì—ì´ì „íŠ¸ë¥¼ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
	â€¢	ì›¹ ì—ì´ì „íŠ¸(Web Agent): ì¸í„°ë„· ë¸Œë¼ìš°ì§• ë‹´ë‹¹
	â€¢	ë¦¬íŠ¸ë¦¬ë²„ ì—ì´ì „íŠ¸(Retriever Agent): ì§€ì‹ ë² ì´ìŠ¤ì—ì„œ ì •ë³´ ê²€ìƒ‰ ë‹´ë‹¹
	â€¢	ì´ë¯¸ì§€ ìƒì„± ì—ì´ì „íŠ¸(Image Generation Agent): ì‹œê° ìë£Œ ìƒì„± ë‹´ë‹¹

ì´ ëª¨ë“  ì—ì´ì „íŠ¸ëŠ” ì‘ì—… ìœ„ì„ê³¼ ìƒí˜¸ì‘ìš©ì„ ê´€ë¦¬í•˜ëŠ” ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ì•„ë˜ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.


### ë©€í‹° ì—ì´ì „íŠ¸ ê³„ì¸µ êµ¬ì¡°ë¡œ ë³µì¡í•œ ì‘ì—… í•´ê²°í•˜ê¸°

ë¦¬ì…‰ì…˜ì´ ë‹¤ê°€ì˜¤ê³  ìˆìŠµë‹ˆë‹¤! ì—¬ëŸ¬ë¶„ì˜ ë„ì›€ìœ¼ë¡œ AlfredëŠ” ì´ì œ ì¤€ë¹„ë¥¼ ê±°ì˜ ë§ˆì³¤ìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ë¬¸ì œê°€ ìƒê²¼ìŠµë‹ˆë‹¤: ë°°íŠ¸ëª¨ë¹Œì´ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤. AlfredëŠ” ë¹¨ë¦¬ ëŒ€ì²´ ì°¨ëŸ‰ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.

ë‹¤í–‰íˆ ë¸Œë£¨ìŠ¤ ì›¨ì¸ì˜ ì‚¶ì„ ë‹¤ë£¬ ëª‡ëª‡ ì „ê¸° ì˜í™”ë“¤ì´ ìˆìœ¼ë‹ˆ, AlfredëŠ” ì˜í™” ì„¸íŠ¸ì¥ì— ë‚¨ê²¨ì§„ ì°¨ëŸ‰ì„ ì°¾ì•„ í˜„ëŒ€ì ì¸ ê¸°ì¤€ì— ë§ê²Œ ê°œì¡°í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ë¬¼ë¡  ì™„ì „ ììœ¨ ì£¼í–‰ ê¸°ëŠ¥ë„ ë°˜ë“œì‹œ í¬í•¨í•´ì•¼ê² ì£ .

ê·¸ëŸ¬ë‚˜ ì´ ì°¨ëŸ‰ì€ ì „ ì„¸ê³„ ì—¬ëŸ¬ ì´¬ì˜ ì¥ì†Œ ì–´ë””ì—ë‚˜ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ë˜ì„œ AlfredëŠ” ì—¬ëŸ¬ë¶„ì˜ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì„ í•´ê²°í•  ìˆ˜ ìˆëŠ” ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ì–´ ì£¼ì‹œê² ìŠµë‹ˆê¹Œ?

ë¨¼ì € í™”ë¬¼ ë¹„í–‰ê¸°ì˜ ì´ë™ ì‹œê°„ì„ ê³„ì‚°í•˜ëŠ” ë„êµ¬ë¥¼ ë§Œë“­ë‹ˆë‹¤.
```python
import math
from typing import Optional, Tuple

from smolagents import tool


@tool
def calculate_cargo_travel_time(
    origin_coords: Tuple[float, float],
    destination_coords: Tuple[float, float],
    cruising_speed_kmh: Optional[float] = 750.0,  # Average speed for cargo planes
) -> float:
    """
    Calculate the travel time for a cargo plane between two points on Earth using great-circle distance.

    Args:
        origin_coords: Tuple of (latitude, longitude) for the starting point
        destination_coords: Tuple of (latitude, longitude) for the destination
        cruising_speed_kmh: Optional cruising speed in km/h (defaults to 750 km/h for typical cargo planes)

    Returns:
        float: The estimated travel time in hours

    Example:
        >>> # Chicago (41.8781Â° N, 87.6298Â° W) to Sydney (33.8688Â° S, 151.2093Â° E)
        >>> result = calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093))
    """

    def to_radians(degrees: float) -> float:
        return degrees * (math.pi / 180)

    # Extract coordinates
    lat1, lon1 = map(to_radians, origin_coords)
    lat2, lon2 = map(to_radians, destination_coords)

    # Earth's radius in kilometers
    EARTH_RADIUS_KM = 6371.0

    # Calculate great-circle distance using the haversine formula
    dlon = lon2 - lon1
    dlat = lat2 - lat1

    a = (
        math.sin(dlat / 2) ** 2
        + math.cos(lat1) * math.cos(lat2) * math.sin(dlon / 2) ** 2
    )
    c = 2 * math.asin(math.sqrt(a))
    distance = EARTH_RADIUS_KM * c

    # Add 10% to account for non-direct routes and air traffic controls
    actual_distance = distance * 1.1

    # Calculate flight time
    # Add 1 hour for takeoff and landing procedures
    flight_time = (actual_distance / cruising_speed_kmh) + 1.0

    # Format the results
    return round(flight_time, 2)


print(calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093)))
```

### ì—ì´ì „íŠ¸ ì„¤ì •í•˜ê¸°

ëª¨ë¸ ì œê³µìë¡œëŠ” Hubì—ì„œ ìƒˆë¡­ê²Œ ì§€ì›ë˜ëŠ” Together AIë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤!

GoogleSearchToolì€ Serper APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ì„ ê²€ìƒ‰í•˜ê¸° ë•Œë¬¸ì—, í™˜ê²½ë³€ìˆ˜ë¡œ ì„¤ì •ëœ SERPAPI_API_KEYì™€ í•¨ê»˜ provider="serpapi"ë¥¼ ì „ë‹¬í•˜ê±°ë‚˜, ë˜ëŠ” SERPER_API_KEYì™€ í•¨ê»˜ provider="serper"ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.

Serp API ì œê³µìë¥¼ ì„¤ì •í•˜ì§€ ì•Šì€ ê²½ìš°, DuckDuckGoSearchToolì„ ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì´ ê²½ìš°ì—ëŠ” ì‚¬ìš©ëŸ‰ ì œí•œ(rate limit)ì´ ìˆìŒì„ ì£¼ì˜í•˜ì„¸ìš”.

```python
import os
from PIL import Image
from smolagents import CodeAgent, GoogleSearchTool, HfApiModel, VisitWebpageTool

model = HfApiModel(model_id="Qwen/Qwen2.5-Coder-32B-Instruct", provider="together")
```
ë¨¼ì € ê°„ë‹¨í•œ ë³´ê³ ì„œë¥¼ ì œê³µí•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ì ì¸(simple) ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ì–´ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
task = """Find all Batman filming locations in the world, calculate the time to transfer via cargo plane to here (we're in Gotham, 40.7128Â° N, 74.0060Â° W), and return them to me as a pandas dataframe.
Also give me some supercar factories with the same cargo plane transfer time."""
```



```python
agent = CodeAgent(
    model=model,
    tools=[GoogleSearchTool("serper"), VisitWebpageTool(), calculate_cargo_travel_time],
    additional_authorized_imports=["pandas"],
    max_steps=20,
)
```

```
|  | Location                                             | Travel Time to Gotham (hours) |
|--|------------------------------------------------------|------------------------------|
| 0  | Necropolis Cemetery, Glasgow, Scotland, UK         | 8.60                         |
| 1  | St. George's Hall, Liverpool, England, UK         | 8.81                         |
| 2  | Two Temple Place, London, England, UK             | 9.17                         |
| 3  | Wollaton Hall, Nottingham, England, UK           | 9.00                         |
| 4  | Knebworth House, Knebworth, Hertfordshire, UK    | 9.15                         |
| 5  | Acton Lane Power Station, Acton Lane, Acton, UK  | 9.16                         |
| 6  | Queensboro Bridge, New York City, USA            | 1.01                         |
| 7  | Wall Street, New York City, USA                  | 1.00                         |
| 8  | Mehrangarh Fort, Jodhpur, Rajasthan, India       | 18.34                        |
| 9  | Turda Gorge, Turda, Romania                      | 11.89                        |
| 10 | Chicago, USA                                     | 2.68                         |
| 11 | Hong Kong, China                                 | 19.99                        |
| 12 | Cardington Studios, Northamptonshire, UK        | 9.10                         |
| 13 | Warner Bros. Leavesden Studios, Hertfordshire, UK | 9.13                         |
| 14 | Westwood, Los Angeles, CA, USA                  | 6.79                         |
| 15 | Woking, UK (McLaren)                             | 9.13                         |
```

ì „ìš© ê³„íš ë‹¨ê³„ë¥¼ ì¶”ê°€í•˜ê³  í”„ë¡¬í”„íŒ…ì„ ë” í’ë¶€í•˜ê²Œ í•˜ì—¬ ì´ë¥¼ ì¡°ê¸ˆ ë” ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê³„íš ë‹¨ê³„(planning steps)ë¥¼ í†µí•´ ì—ì´ì „íŠ¸ëŠ” ë¯¸ë¦¬ ìƒê°í•˜ê³  ë‹¤ìŒ ë‹¨ê³„ë¥¼ ê³„íší•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ë” ë³µì¡í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
agent.planning_interval = 4

detailed_report = agent.run(f"""
You're an expert analyst. You make comprehensive reports after visiting many websites.
Don't hesitate to search for many queries at once in a for loop.
For each data point that you find, visit the source url to confirm numbers.

{task}
""")

print(detailed_report)
```

```
|  | Location                                         | Travel Time (hours) |
|--|--------------------------------------------------|---------------------|
| 0  | Bridge of Sighs, Glasgow Necropolis, Glasgow, UK | 8.6                 |
| 1  | Wishart Street, Glasgow, Scotland, UK         | 8.6                 |
```


### âœŒï¸ ë‘ ê°œì˜ ì—ì´ì „íŠ¸ë¡œ ì‘ì—… ë¶„ë¦¬í•˜ê¸°

ë©€í‹° ì—ì´ì „íŠ¸ êµ¬ì¡°ëŠ” ì„œë¡œ ë‹¤ë¥¸ í•˜ìœ„ ì‘ì—…ì— ëŒ€í•œ ë©”ëª¨ë¦¬ë¥¼ ë¶„ë¦¬í•  ìˆ˜ ìˆê²Œ í•˜ë©°, ë‹¤ìŒ ë‘ ê°€ì§€ í° ì¥ì ì„ ì œê³µí•©ë‹ˆë‹¤:
	â€¢	ê° ì—ì´ì „íŠ¸ëŠ” ìì‹ ì˜ í•µì‹¬ ì‘ì—…ì—ë§Œ ì§‘ì¤‘í•˜ì—¬ ì„±ëŠ¥ì´ í–¥ìƒë©ë‹ˆë‹¤.
	â€¢	ë©”ëª¨ë¦¬ë¥¼ ë¶„ë¦¬í•˜ë©´ ê° ë‹¨ê³„ì—ì„œì˜ ì…ë ¥ í† í° ìˆ˜ê°€ ì¤„ì–´ë“¤ì–´ ì§€ì—°(latency)ê³¼ ë¹„ìš©ì´ ê°ì†Œí•©ë‹ˆë‹¤.

ì „ë‹´ ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸ì™€ ì´ë¥¼ ê´€ë¦¬í•˜ëŠ” ë˜ ë‹¤ë¥¸ ë§¤ë‹ˆì € ì—ì´ì „íŠ¸ë¥¼ íŒ€ìœ¼ë¡œ êµ¬ì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ë§¤ë‹ˆì € ì—ì´ì „íŠ¸ëŠ” ìµœì¢… ë³´ê³ ì„œë¥¼ ì‘ì„±í•  ë•Œ ì‹œê°í™” ê¸°ëŠ¥ì´ í•„ìš”í•˜ë¯€ë¡œ, ì¶”ê°€ ì„í¬íŠ¸ë¡œ plotly, ê·¸ë¦¬ê³  ê³µê°„ ì‹œê°í™”ë¥¼ ìœ„í•œ geopandasì™€ shapelyë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.


```python
model = HfApiModel(
    "Qwen/Qwen2.5-Coder-32B-Instruct", provider="together", max_tokens=8096
)

web_agent = CodeAgent(
    model=model,
    tools=[
        GoogleSearchTool(provider="serper"),
        VisitWebpageTool(),
        calculate_cargo_travel_time,
    ],
    name="web_agent",
    description="Browses the web to find information",
    verbosity_level=0,
    max_steps=10,
)
```

ë§¤ë‹ˆì € ì—ì´ì „íŠ¸ëŠ” ë” ë³µì¡í•œ ì‚¬ê³  ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ë” ê°•ë ¥í•œ ëª¨ë¸ì¸ DeepSeek-R1ì„ ì‚¬ìš©í•˜ê³ , ì—¬ê¸°ì— ì¶”ê°€ë¡œ **planning_interval**ì„ ì„¤ì •í•©ë‹ˆë‹¤.

```python
from smolagents.utils import encode_image_base64, make_image_url
from smolagents import OpenAIServerModel


def check_reasoning_and_plot(final_answer, agent_memory):
    multimodal_model = OpenAIServerModel("gpt-4o", max_tokens=8096)
    filepath = "saved_map.png"
    assert os.path.exists(filepath), "Make sure to save the plot under saved_map.png!"
    image = Image.open(filepath)
    prompt = (
        f"Here is a user-given task and the agent steps: {agent_memory.get_succinct_steps()}. Now here is the plot that was made."
        "Please check that the reasoning process and plot are correct: do they correctly answer the given task?"
        "First list reasons why yes/no, then write your final decision: PASS in caps lock if it is satisfactory, FAIL if it is not."
        "Don't be harsh: if the plot mostly solves the task, it should pass."
        "To pass, a plot should be made using px.scatter_map and not any other method (scatter_map looks nicer)."
    )
    messages = [
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": prompt,
                },
                {
                    "type": "image_url",
                    "image_url": {"url": make_image_url(encode_image_base64(image))},
                },
            ],
        }
    ]
    output = multimodal_model(messages).content
    print("Feedback: ", output)
    if "FAIL" in output:
        raise Exception(output)
    return True


manager_agent = CodeAgent(
    model=HfApiModel("deepseek-ai/DeepSeek-R1", provider="together", max_tokens=8096),
    tools=[calculate_cargo_travel_time],
    managed_agents=[web_agent],
    additional_authorized_imports=[
        "geopandas",
        "plotly",
        "shapely",
        "json",
        "pandas",
        "numpy",
    ],
    planning_interval=5,
    verbosity_level=2,
    final_answer_checks=[check_reasoning_and_plot],
    max_steps=15,
)
```

```python
manager_agent.visualize()
```

ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œ ìƒì„±ë˜ë©°, ì—ì´ì „íŠ¸ì™€ ì‚¬ìš©ëœ ë„êµ¬ ì‚¬ì´ì˜ êµ¬ì¡° ë° ê´€ê³„ë¥¼ ì´í•´í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤:

```shell
CodeAgent | deepseek-ai/DeepSeek-R1
â”œâ”€â”€ âœ… Authorized imports: ['geopandas', 'plotly', 'shapely', 'json', 'pandas', 'numpy']
â”œâ”€â”€ ğŸ› ï¸ Tools:
â”‚   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”‚   â”ƒ Name                        â”ƒ Description                           â”ƒ Arguments                             â”ƒ
â”‚   â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚   â”‚ calculate_cargo_travel_time â”‚ Calculate the travel time for a cargo â”‚ origin_coords (`array`): Tuple of     â”‚
â”‚   â”‚                             â”‚ plane between two points on Earth     â”‚ (latitude, longitude) for the         â”‚
â”‚   â”‚                             â”‚ using great-circle distance.          â”‚ starting point                        â”‚
â”‚   â”‚                             â”‚                                       â”‚ destination_coords (`array`): Tuple   â”‚
â”‚   â”‚                             â”‚                                       â”‚ of (latitude, longitude) for the      â”‚
â”‚   â”‚                             â”‚                                       â”‚ destination                           â”‚
â”‚   â”‚                             â”‚                                       â”‚ cruising_speed_kmh (`number`):        â”‚
â”‚   â”‚                             â”‚                                       â”‚ Optional cruising speed in km/h       â”‚
â”‚   â”‚                             â”‚                                       â”‚ (defaults to 750 km/h for typical     â”‚
â”‚   â”‚                             â”‚                                       â”‚ cargo planes)                         â”‚
â”‚   â”‚ final_answer                â”‚ Provides a final answer to the given  â”‚ answer (`any`): The final answer to   â”‚
â”‚   â”‚                             â”‚ problem.                              â”‚ the problem                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€ ğŸ¤– Managed agents:
    â””â”€â”€ web_agent | CodeAgent | Qwen/Qwen2.5-Coder-32B-Instruct
        â”œâ”€â”€ âœ… Authorized imports: []
        â”œâ”€â”€ ğŸ“ Description: Browses the web to find information
        â””â”€â”€ ğŸ› ï¸ Tools:
            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
            â”ƒ Name                        â”ƒ Description                       â”ƒ Arguments                         â”ƒ
            â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
            â”‚ web_search                  â”‚ Performs a google web search for  â”‚ query (`string`): The search      â”‚
            â”‚                             â”‚ your query then returns a string  â”‚ query to perform.                 â”‚
            â”‚                             â”‚ of the top search results.        â”‚ filter_year (`integer`):          â”‚
            â”‚                             â”‚                                   â”‚ Optionally restrict results to a  â”‚
            â”‚                             â”‚                                   â”‚ certain year                      â”‚
            â”‚ visit_webpage               â”‚ Visits a webpage at the given url â”‚ url (`string`): The url of the    â”‚
            â”‚                             â”‚ and reads its content as a        â”‚ webpage to visit.                 â”‚
            â”‚                             â”‚ markdown string. Use this to      â”‚                                   â”‚
            â”‚                             â”‚ browse webpages.                  â”‚                                   â”‚
            â”‚ calculate_cargo_travel_time â”‚ Calculate the travel time for a   â”‚ origin_coords (`array`): Tuple of â”‚
            â”‚                             â”‚ cargo plane between two points on â”‚ (latitude, longitude) for the     â”‚
            â”‚                             â”‚ Earth using great-circle          â”‚ starting point                    â”‚
            â”‚                             â”‚ distance.                         â”‚ destination_coords (`array`):     â”‚
            â”‚                             â”‚                                   â”‚ Tuple of (latitude, longitude)    â”‚
            â”‚                             â”‚                                   â”‚ for the destination               â”‚
            â”‚                             â”‚                                   â”‚ cruising_speed_kmh (`number`):    â”‚
            â”‚                             â”‚                                   â”‚ Optional cruising speed in km/h   â”‚
            â”‚                             â”‚                                   â”‚ (defaults to 750 km/h for typical â”‚
            â”‚                             â”‚                                   â”‚ cargo planes)                     â”‚
            â”‚ final_answer                â”‚ Provides a final answer to the    â”‚ answer (`any`): The final answer  â”‚
            â”‚                             â”‚ given problem.                    â”‚ to the problem                    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
manager_agent.run("""
Find all Batman filming locations in the world, calculate the time to transfer via cargo plane to here (we're in Gotham, 40.7128Â° N, 74.0060Â° W).
Also give me some supercar factories with the same cargo plane transfer time. You need at least 6 points in total.
Represent this as spatial map of the world, with the locations represented as scatter points with a color that depends on the travel time, and save it to saved_map.png!

Here's an example of how to plot and return a map:
import plotly.express as px
df = px.data.carshare()
fig = px.scatter_map(df, lat="centroid_lat", lon="centroid_lon", text="name", color="peak_hour", size=100,
     color_continuous_scale=px.colors.sequential.Magma, size_max=15, zoom=1)
fig.show()
fig.write_image("saved_image.png")
final_answer(fig)

Never try to process strings using code: when you have a string to read, just print it and you'll see it.
""")
```

ì—¬ëŸ¬ë¶„ì˜ ì‹¤í–‰ ê²°ê³¼ëŠ” ì–´ë• ëŠ”ì§€ ëª¨ë¥´ê² ì§€ë§Œ, ì œ ê²½ìš°ì—ëŠ” ë§¤ë‹ˆì € ì—ì´ì „íŠ¸ê°€ ì›¹ ì—ì´ì „íŠ¸ì—ê²Œ ì‘ì—…ì„ ëŠ¥ìˆ™í•˜ê²Œ ë‚˜ëˆ„ì–´ ì¤¬ìŠµë‹ˆë‹¤. ë¨¼ì € (1) ë°°íŠ¸ë§¨ ì´¬ì˜ ì¥ì†Œë¥¼ ê²€ìƒ‰í•œ ë’¤, (2) ìŠˆí¼ì¹´ ê³µì¥ë“¤ì„ ì°¾ì•˜ê³ , ì´í›„ì— ë¦¬ìŠ¤íŠ¸ë¥¼ ì¢…í•©í•˜ì—¬ ì§€ë„ë¥¼ ê·¸ë ¸ìŠµë‹ˆë‹¤.

ì´ì œ ì—ì´ì „íŠ¸ ìƒíƒœì—ì„œ ì§ì ‘ ì§€ë„ë¥¼ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤:

```python
manager_agent.python_executor.state["fig"]
```

![alt text](image-7.png)
